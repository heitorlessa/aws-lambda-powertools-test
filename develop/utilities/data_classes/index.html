
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Utility">
      
      
        <meta name="author" content="Amazon Web Services">
      
      
      
        <link rel="prev" href="../validation/">
      
      
        <link rel="next" href="../parser/">
      
      <link rel="icon" href="../../media/aws-logo-light.svg">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>Event Source Data Classes - Powertools for AWS Lambda (Python)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#key-features" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Powertools for AWS Lambda (Python)" class="md-header__button md-logo" aria-label="Powertools for AWS Lambda (Python)" data-md-component="logo">
      
  <img src="../../media/aws-logo-light.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Powertools for AWS Lambda (Python)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Event Source Data Classes
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aws-powertools/powertools-lambda-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Powertools for AWS Lambda (Python)" class="md-nav__button md-logo" aria-label="Powertools for AWS Lambda (Python)" data-md-component="logo">
      
  <img src="../../media/aws-logo-light.svg" alt="logo">

    </a>
    Powertools for AWS Lambda (Python)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aws-powertools/powertools-lambda-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Homepage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        Tutorial
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../api/" target="_blank" class="md-nav__link">
        API reference
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/" class="md-nav__link">
        Upgrade guide
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../we_made_this/" class="md-nav__link">
        We Made This (Community)
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Core utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Core utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/tracer/" class="md-nav__link">
        Tracer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/logger/" class="md-nav__link">
        Logger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/metrics/" class="md-nav__link">
        Metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_4" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8_4" id="__nav_8_4_label" tabindex="0">
          Event Handler
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8_4">
          <span class="md-nav__icon md-icon"></span>
          Event Handler
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/event_handler/api_gateway/" class="md-nav__link">
        REST API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/event_handler/appsync/" class="md-nav__link">
        GraphQL API
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../parameters/" class="md-nav__link">
        Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../batch/" class="md-nav__link">
        Batch Processing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../typing/" class="md-nav__link">
        Typing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../validation/" class="md-nav__link">
        Validation
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Event Source Data Classes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Event Source Data Classes
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    Key features
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting started
  </a>
  
    <nav class="md-nav" aria-label="Getting started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utilizing-the-data-classes" class="md-nav__link">
    Utilizing the data classes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-event-sources" class="md-nav__link">
    Supported event sources
  </a>
  
    <nav class="md-nav" aria-label="Supported event sources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#active-mq" class="md-nav__link">
    Active MQ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-gateway-authorizer" class="md-nav__link">
    API Gateway Authorizer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-gateway-authorizer-v2" class="md-nav__link">
    API Gateway Authorizer V2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-gateway-proxy" class="md-nav__link">
    API Gateway Proxy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-gateway-proxy-v2" class="md-nav__link">
    API Gateway Proxy V2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-load-balancer" class="md-nav__link">
    Application Load Balancer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appsync-authorizer" class="md-nav__link">
    AppSync Authorizer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appsync-resolver" class="md-nav__link">
    AppSync Resolver
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-config-rule" class="md-nav__link">
    AWS Config Rule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloudwatch-dashboard-custom-widget" class="md-nav__link">
    CloudWatch Dashboard Custom Widget
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloudwatch-logs" class="md-nav__link">
    CloudWatch Logs
  </a>
  
    <nav class="md-nav" aria-label="CloudWatch Logs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kinesis-integration" class="md-nav__link">
    Kinesis integration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codepipeline-job" class="md-nav__link">
    CodePipeline Job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cognito-user-pool" class="md-nav__link">
    Cognito User Pool
  </a>
  
    <nav class="md-nav" aria-label="Cognito User Pool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-confirmation-example" class="md-nav__link">
    Post Confirmation Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-auth-challenge-example" class="md-nav__link">
    Define Auth Challenge Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-auth-challenge-example" class="md-nav__link">
    Create Auth Challenge Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-auth-challenge-response-example" class="md-nav__link">
    Verify Auth Challenge Response Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-contact-flow" class="md-nav__link">
    Connect Contact Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamodb-streams" class="md-nav__link">
    DynamoDB Streams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventbridge" class="md-nav__link">
    EventBridge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kafka" class="md-nav__link">
    Kafka
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kinesis-streams" class="md-nav__link">
    Kinesis streams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kinesis-firehose-delivery-stream" class="md-nav__link">
    Kinesis Firehose delivery stream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lambda-function-url" class="md-nav__link">
    Lambda Function URL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rabbit-mq" class="md-nav__link">
    Rabbit MQ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3" class="md-nav__link">
    S3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3-object-lambda" class="md-nav__link">
    S3 Object Lambda
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3-eventbridge-notification" class="md-nav__link">
    S3 EventBridge Notification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ses" class="md-nav__link">
    SES
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sns" class="md-nav__link">
    SNS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqs" class="md-nav__link">
    SQS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vpc-lattice" class="md-nav__link">
    VPC Lattice
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced" class="md-nav__link">
    Advanced
  </a>
  
    <nav class="md-nav" aria-label="Advanced">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugging" class="md-nav__link">
    Debugging
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../parser/" class="md-nav__link">
        Parser (Pydantic)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../idempotency/" class="md-nav__link">
        Idempotency
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../feature_flags/" class="md-nav__link">
        Feature flags
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../streaming/" class="md-nav__link">
        Streaming
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../middleware_factory/" class="md-nav__link">
        Middleware factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jmespath_functions/" class="md-nav__link">
        JMESPath Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/aws-cloudformation/custom-resource-helper" target="_blank" class="md-nav__link">
        CloudFormation Custom Resources
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    Key features
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting started
  </a>
  
    <nav class="md-nav" aria-label="Getting started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utilizing-the-data-classes" class="md-nav__link">
    Utilizing the data classes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-event-sources" class="md-nav__link">
    Supported event sources
  </a>
  
    <nav class="md-nav" aria-label="Supported event sources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#active-mq" class="md-nav__link">
    Active MQ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-gateway-authorizer" class="md-nav__link">
    API Gateway Authorizer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-gateway-authorizer-v2" class="md-nav__link">
    API Gateway Authorizer V2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-gateway-proxy" class="md-nav__link">
    API Gateway Proxy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-gateway-proxy-v2" class="md-nav__link">
    API Gateway Proxy V2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-load-balancer" class="md-nav__link">
    Application Load Balancer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appsync-authorizer" class="md-nav__link">
    AppSync Authorizer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appsync-resolver" class="md-nav__link">
    AppSync Resolver
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-config-rule" class="md-nav__link">
    AWS Config Rule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloudwatch-dashboard-custom-widget" class="md-nav__link">
    CloudWatch Dashboard Custom Widget
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloudwatch-logs" class="md-nav__link">
    CloudWatch Logs
  </a>
  
    <nav class="md-nav" aria-label="CloudWatch Logs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kinesis-integration" class="md-nav__link">
    Kinesis integration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codepipeline-job" class="md-nav__link">
    CodePipeline Job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cognito-user-pool" class="md-nav__link">
    Cognito User Pool
  </a>
  
    <nav class="md-nav" aria-label="Cognito User Pool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-confirmation-example" class="md-nav__link">
    Post Confirmation Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-auth-challenge-example" class="md-nav__link">
    Define Auth Challenge Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-auth-challenge-example" class="md-nav__link">
    Create Auth Challenge Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-auth-challenge-response-example" class="md-nav__link">
    Verify Auth Challenge Response Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-contact-flow" class="md-nav__link">
    Connect Contact Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamodb-streams" class="md-nav__link">
    DynamoDB Streams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventbridge" class="md-nav__link">
    EventBridge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kafka" class="md-nav__link">
    Kafka
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kinesis-streams" class="md-nav__link">
    Kinesis streams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kinesis-firehose-delivery-stream" class="md-nav__link">
    Kinesis Firehose delivery stream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lambda-function-url" class="md-nav__link">
    Lambda Function URL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rabbit-mq" class="md-nav__link">
    Rabbit MQ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3" class="md-nav__link">
    S3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3-object-lambda" class="md-nav__link">
    S3 Object Lambda
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s3-eventbridge-notification" class="md-nav__link">
    S3 EventBridge Notification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ses" class="md-nav__link">
    SES
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sns" class="md-nav__link">
    SNS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqs" class="md-nav__link">
    SQS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vpc-lattice" class="md-nav__link">
    VPC Lattice
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced" class="md-nav__link">
    Advanced
  </a>
  
    <nav class="md-nav" aria-label="Advanced">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugging" class="md-nav__link">
    Debugging
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Event Source Data Classes</h1>

<!-- markdownlint-disable MD043 -->

<p>Event Source Data Classes utility provides classes self-describing Lambda event sources.</p>
<h2 id="key-features">Key features<a class="headerlink" href="#key-features" title="Permanent link">&para;</a></h2>
<ul>
<li>Type hinting and code completion for common event types</li>
<li>Helper functions for decoding/deserializing nested fields</li>
<li>Docstrings for fields contained in event schemas</li>
</ul>
<p><strong>Background</strong></p>
<p>When authoring Lambda functions, you often need to understand the schema of the event dictionary which is passed to the
handler. There are several common event types which follow a specific schema, depending on the service triggering the
Lambda function.</p>
<h2 id="getting-started">Getting started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<h3 id="utilizing-the-data-classes">Utilizing the data classes<a class="headerlink" href="#utilizing-the-data-classes" title="Permanent link">&para;</a></h3>
<p>The classes are initialized by passing in the Lambda event object into the constructor of the appropriate data class or
by using the <code>event_source</code> decorator.</p>
<p>For example, if your Lambda function is being triggered by an API Gateway proxy integration, you can use the
<code>APIGatewayProxyEvent</code> class.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">APIGatewayProxyEvent</span>
</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="hll">    <span class="n">event</span> <span class="o">=</span> <span class="n">APIGatewayProxyEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span>    <span class="k">if</span> <span class="s1">&#39;helloworld&#39;</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">path</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">http_method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="n">do_something_with</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<p>Same example as above, but using the <code>event_source</code> decorator</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">APIGatewayProxyEvent</span>
</span>
<span class="hll"><span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">APIGatewayProxyEvent</span><span class="p">)</span>
</span><span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">APIGatewayProxyEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;helloworld&#39;</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">path</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">http_method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="n">do_something_with</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<p>Log Data Event for Troubleshooting</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">APIGatewayProxyEvent</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.logging.logger</span> <span class="kn">import</span> <span class="n">Logger</span>

<span class="hll"><span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="s2">&quot;hello_logs&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">)</span>
</span>
<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">APIGatewayProxyEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">APIGatewayProxyEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="hll">    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<p><strong>Autocomplete with self-documented properties and methods</strong></p>
<p><img alt="Utilities Data Classes" src="../../media/utilities_data_classes.png" /></p>
<h2 id="supported-event-sources">Supported event sources<a class="headerlink" href="#supported-event-sources" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Event Source</th>
<th>Data_class</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#active-mq">Active MQ</a></td>
<td><code>ActiveMQEvent</code></td>
</tr>
<tr>
<td><a href="#api-gateway-authorizer">API Gateway Authorizer</a></td>
<td><code>APIGatewayAuthorizerRequestEvent</code></td>
</tr>
<tr>
<td><a href="#api-gateway-authorizer-v2">API Gateway Authorizer V2</a></td>
<td><code>APIGatewayAuthorizerEventV2</code></td>
</tr>
<tr>
<td><a href="#api-gateway-proxy">API Gateway Proxy</a></td>
<td><code>APIGatewayProxyEvent</code></td>
</tr>
<tr>
<td><a href="#api-gateway-proxy-v2">API Gateway Proxy V2</a></td>
<td><code>APIGatewayProxyEventV2</code></td>
</tr>
<tr>
<td><a href="#application-load-balancer">Application Load Balancer</a></td>
<td><code>ALBEvent</code></td>
</tr>
<tr>
<td><a href="#appsync-authorizer">AppSync Authorizer</a></td>
<td><code>AppSyncAuthorizerEvent</code></td>
</tr>
<tr>
<td><a href="#appsync-resolver">AppSync Resolver</a></td>
<td><code>AppSyncResolverEvent</code></td>
</tr>
<tr>
<td><a href="#aws-config-rule">AWS Config Rule</a></td>
<td><code>AWSConfigRuleEvent</code></td>
</tr>
<tr>
<td><a href="#cloudwatch-dashboard-custom-widget">CloudWatch Dashboard Custom Widget</a></td>
<td><code>CloudWatchDashboardCustomWidgetEvent</code></td>
</tr>
<tr>
<td><a href="#cloudwatch-logs">CloudWatch Logs</a></td>
<td><code>CloudWatchLogsEvent</code></td>
</tr>
<tr>
<td><a href="#codepipeline-job">CodePipeline Job Event</a></td>
<td><code>CodePipelineJobEvent</code></td>
</tr>
<tr>
<td><a href="#cognito-user-pool">Cognito User Pool</a></td>
<td>Multiple available under <code>cognito_user_pool_event</code></td>
</tr>
<tr>
<td><a href="#connect-contact-flow">Connect Contact Flow</a></td>
<td><code>ConnectContactFlowEvent</code></td>
</tr>
<tr>
<td><a href="#dynamodb-streams">DynamoDB streams</a></td>
<td><code>DynamoDBStreamEvent</code>, <code>DynamoDBRecordEventName</code></td>
</tr>
<tr>
<td><a href="#eventbridge">EventBridge</a></td>
<td><code>EventBridgeEvent</code></td>
</tr>
<tr>
<td><a href="#kafka">Kafka</a></td>
<td><code>KafkaEvent</code></td>
</tr>
<tr>
<td><a href="#kinesis-streams">Kinesis Data Stream</a></td>
<td><code>KinesisStreamEvent</code></td>
</tr>
<tr>
<td><a href="#kinesis-firehose-delivery-stream">Kinesis Firehose Delivery Stream</a></td>
<td><code>KinesisFirehoseEvent</code></td>
</tr>
<tr>
<td><a href="#lambda-function-url">Lambda Function URL</a></td>
<td><code>LambdaFunctionUrlEvent</code></td>
</tr>
<tr>
<td><a href="#rabbit-mq">Rabbit MQ</a></td>
<td><code>RabbitMQEvent</code></td>
</tr>
<tr>
<td><a href="#s3">S3</a></td>
<td><code>S3Event</code></td>
</tr>
<tr>
<td><a href="#s3-object-lambda">S3 Object Lambda</a></td>
<td><code>S3ObjectLambdaEvent</code></td>
</tr>
<tr>
<td><a href="#s3-eventbridge-notification">S3 EventBridge Notification</a></td>
<td><code>S3EventBridgeNotificationEvent</code></td>
</tr>
<tr>
<td><a href="#ses">SES</a></td>
<td><code>SESEvent</code></td>
</tr>
<tr>
<td><a href="#sns">SNS</a></td>
<td><code>SNSEvent</code></td>
</tr>
<tr>
<td><a href="#sqs">SQS</a></td>
<td><code>SQSEvent</code></td>
</tr>
<tr>
<td><a href="#vpc-lattice">VPC Lattice</a></td>
<td><code>VPCLatticeEvent</code></td>
</tr>
</tbody>
</table>
<details class="info" open="open">
<summary>Info</summary>
<p>The examples provided below are far from exhaustive - the data classes themselves are designed to provide a form of
documentation inherently (via autocompletion, types and docstrings).</p>
</details>
<h3 id="active-mq">Active MQ<a class="headerlink" href="#active-mq" title="Permanent link">&para;</a></h3>
<p>It is used for <a href="https://docs.aws.amazon.com/lambda/latest/dg/with-mq.html" target="_blank">Active MQ payloads</a>, also see
the <a href="https://aws.amazon.com/blogs/compute/using-amazon-mq-as-an-event-source-for-aws-lambda/" target="_blank">AWS blog post</a>
for more details.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>

<span class="kn">from</span> <span class="nn">aws_lambda_powertools</span> <span class="kn">import</span> <span class="n">Logger</span>
<span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.active_mq_event</span> <span class="kn">import</span> <span class="n">ActiveMQEvent</span>
</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">()</span>

<span class="hll"><span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">ActiveMQEvent</span><span class="p">)</span>
</span><span class="hll"><span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">ActiveMQEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
</span>    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">messages</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MessageID: </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">message_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">json_data</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Process json in base64 encoded data str&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="api-gateway-authorizer">API Gateway Authorizer<a class="headerlink" href="#api-gateway-authorizer" title="Permanent link">&para;</a></h3>
<blockquote>
<p>New in 1.20.0</p>
</blockquote>
<p>It is used for <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html" target="_blank">API Gateway Rest API Lambda Authorizer payload</a>.</p>
<p>Use <strong><code>APIGatewayAuthorizerRequestEvent</code></strong> for type <code>REQUEST</code> and <strong><code>APIGatewayAuthorizerTokenEvent</code></strong> for type <code>TOKEN</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">app_type_request.py</label><label for="__tabbed_5_2">app_type_token.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>This example uses the <code>APIGatewayAuthorizerResponse</code> to decline a given request if the user is not found.</p>
<p>When the user is found, it includes the user details in the request context that will be available to the back-end, and returns a full access policy for admin users.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span>
<span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.api_gateway_authorizer_event</span> <span class="kn">import</span> <span class="p">(</span>
</span><span class="hll">    <span class="n">DENY_ALL_RESPONSE</span><span class="p">,</span>
</span><span class="hll">    <span class="n">APIGatewayAuthorizerRequestEvent</span><span class="p">,</span>
</span><span class="hll">    <span class="n">APIGatewayAuthorizerResponse</span><span class="p">,</span>
</span><span class="hll">    <span class="n">HttpVerb</span><span class="p">,</span>
</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">secrets</span> <span class="kn">import</span> <span class="n">compare_digest</span>


<span class="k">def</span> <span class="nf">get_user_by_token</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">compare_digest</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="s2">&quot;admin-foo&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Admin&quot;</span><span class="p">,</span> <span class="s2">&quot;isAdmin&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">compare_digest</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="s2">&quot;regular-foo&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Joe&quot;</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>


<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">APIGatewayAuthorizerRequestEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">APIGatewayAuthorizerRequestEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">get_user_by_token</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">get_header_value</span><span class="p">(</span><span class="s2">&quot;Authorization&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># No user was found</span>
        <span class="c1"># to return 401 - `{&quot;message&quot;:&quot;Unauthorized&quot;}`, but pollutes lambda error count metrics</span>
        <span class="c1"># raise Exception(&quot;Unauthorized&quot;)</span>
        <span class="c1"># to return 403 - `{&quot;message&quot;:&quot;Forbidden&quot;}`</span>
<span class="hll">        <span class="k">return</span> <span class="n">DENY_ALL_RESPONSE</span>
</span>
    <span class="c1"># parse the `methodArn` as an `APIGatewayRouteArn`</span>
    <span class="n">arn</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">parsed_arn</span>

    <span class="c1"># Create the response builder from parts of the `methodArn`</span>
    <span class="c1"># and set the logged in user id and context</span>
<span class="hll">    <span class="n">policy</span> <span class="o">=</span> <span class="n">APIGatewayAuthorizerResponse</span><span class="p">(</span>
</span><span class="hll">        <span class="n">principal_id</span><span class="o">=</span><span class="n">user</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
</span><span class="hll">        <span class="n">context</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>
</span><span class="hll">        <span class="n">region</span><span class="o">=</span><span class="n">arn</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
</span><span class="hll">        <span class="n">aws_account_id</span><span class="o">=</span><span class="n">arn</span><span class="o">.</span><span class="n">aws_account_id</span><span class="p">,</span>
</span><span class="hll">        <span class="n">api_id</span><span class="o">=</span><span class="n">arn</span><span class="o">.</span><span class="n">api_id</span><span class="p">,</span>
</span><span class="hll">        <span class="n">stage</span><span class="o">=</span><span class="n">arn</span><span class="o">.</span><span class="n">stage</span><span class="p">,</span>
</span>    <span class="p">)</span>

    <span class="c1"># Conditional IAM Policy</span>
    <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;isAdmin&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
<span class="hll">        <span class="n">policy</span><span class="o">.</span><span class="n">allow_all_routes</span><span class="p">()</span>
</span>    <span class="k">else</span><span class="p">:</span>
<span class="hll">        <span class="n">policy</span><span class="o">.</span><span class="n">allow_route</span><span class="p">(</span><span class="n">HttpVerb</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="s2">&quot;/user-profile&quot;</span><span class="p">)</span>
</span>
    <span class="k">return</span> <span class="n">policy</span><span class="o">.</span><span class="n">asdict</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span>
<span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.api_gateway_authorizer_event</span> <span class="kn">import</span> <span class="p">(</span>
</span><span class="hll">    <span class="n">APIGatewayAuthorizerTokenEvent</span><span class="p">,</span>
</span><span class="hll">    <span class="n">APIGatewayAuthorizerResponse</span><span class="p">,</span>
</span><span class="hll"><span class="p">)</span>
</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">APIGatewayAuthorizerTokenEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">APIGatewayAuthorizerTokenEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">arn</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">parsed_arn</span>

<span class="hll">    <span class="n">policy</span> <span class="o">=</span> <span class="n">APIGatewayAuthorizerResponse</span><span class="p">(</span>
</span><span class="hll">        <span class="n">principal_id</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">region</span><span class="o">=</span><span class="n">arn</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
</span><span class="hll">        <span class="n">aws_account_id</span><span class="o">=</span><span class="n">arn</span><span class="o">.</span><span class="n">aws_account_id</span><span class="p">,</span>
</span><span class="hll">        <span class="n">api_id</span><span class="o">=</span><span class="n">arn</span><span class="o">.</span><span class="n">api_id</span><span class="p">,</span>
</span><span class="hll">        <span class="n">stage</span><span class="o">=</span><span class="n">arn</span><span class="o">.</span><span class="n">stage</span>
</span><span class="hll">    <span class="p">)</span>
</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">authorization_token</span> <span class="o">==</span> <span class="s2">&quot;42&quot;</span><span class="p">:</span>
<span class="hll">        <span class="n">policy</span><span class="o">.</span><span class="n">allow_all_routes</span><span class="p">()</span>
</span>    <span class="k">else</span><span class="p">:</span>
<span class="hll">        <span class="n">policy</span><span class="o">.</span><span class="n">deny_all_routes</span><span class="p">()</span>
</span><span class="hll">    <span class="k">return</span> <span class="n">policy</span><span class="o">.</span><span class="n">asdict</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="api-gateway-authorizer-v2">API Gateway Authorizer V2<a class="headerlink" href="#api-gateway-authorizer-v2" title="Permanent link">&para;</a></h3>
<blockquote>
<p>New in 1.20.0</p>
</blockquote>
<p>It is used for <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-lambda-authorizer.html" target="_blank">API Gateway HTTP API Lambda Authorizer payload version 2</a>.
See also <a href="https://aws.amazon.com/blogs/compute/introducing-iam-and-lambda-authorizers-for-amazon-api-gateway-http-apis/" target="_blank">this blog post</a> for more details.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>This example looks up user details via <code>x-token</code> header. It uses <code>APIGatewayAuthorizerResponseV2</code> to return a deny policy when user is not found or authorized.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span>
<span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.api_gateway_authorizer_event</span> <span class="kn">import</span> <span class="p">(</span>
</span><span class="hll">    <span class="n">APIGatewayAuthorizerEventV2</span><span class="p">,</span>
</span><span class="hll">    <span class="n">APIGatewayAuthorizerResponseV2</span><span class="p">,</span>
</span><span class="hll"><span class="p">)</span>
</span><span class="kn">from</span> <span class="nn">secrets</span> <span class="kn">import</span> <span class="n">compare_digest</span>


<span class="k">def</span> <span class="nf">get_user_by_token</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">compare_digest</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="s2">&quot;Foo&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Foo&quot;</span><span class="p">}</span>
    <span class="k">return</span> <span class="kc">None</span>


<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">APIGatewayAuthorizerEventV2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">APIGatewayAuthorizerEventV2</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">get_user_by_token</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">get_header_value</span><span class="p">(</span><span class="s2">&quot;x-token&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># No user was found, so we return not authorized</span>
<span class="hll">        <span class="k">return</span> <span class="n">APIGatewayAuthorizerResponseV2</span><span class="p">()</span><span class="o">.</span><span class="n">asdict</span><span class="p">()</span>
</span>
    <span class="c1"># Found the user and setting the details in the context</span>
<span class="hll">    <span class="k">return</span> <span class="n">APIGatewayAuthorizerResponseV2</span><span class="p">(</span><span class="n">authorize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">asdict</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="api-gateway-proxy">API Gateway Proxy<a class="headerlink" href="#api-gateway-proxy" title="Permanent link">&para;</a></h3>
<p>It is used for either API Gateway REST API or HTTP API using v1 proxy event.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">APIGatewayProxyEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">APIGatewayProxyEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">APIGatewayProxyEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;helloworld&quot;</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">path</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">http_method</span> <span class="o">==</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
        <span class="n">request_context</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">request_context</span>
        <span class="n">identity</span> <span class="o">=</span> <span class="n">request_context</span><span class="o">.</span><span class="n">identity</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">identity</span><span class="o">.</span><span class="n">user</span>
        <span class="n">do_something_with</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">json_body</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="api-gateway-proxy-v2">API Gateway Proxy V2<a class="headerlink" href="#api-gateway-proxy-v2" title="Permanent link">&para;</a></h3>
<p>It is used for HTTP API using v2 proxy event.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">APIGatewayProxyEventV2</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">APIGatewayProxyEventV2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">APIGatewayProxyEventV2</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;helloworld&quot;</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">path</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">http_method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
        <span class="n">do_something_with</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">json_body</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">query_string_parameters</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="application-load-balancer">Application Load Balancer<a class="headerlink" href="#application-load-balancer" title="Permanent link">&para;</a></h3>
<p>Is it used for Application load balancer event.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:1"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">ALBEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">ALBEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">ALBEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;helloworld&quot;</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">path</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">http_method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
        <span class="n">do_something_with</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">json_body</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">query_string_parameters</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="appsync-authorizer">AppSync Authorizer<a class="headerlink" href="#appsync-authorizer" title="Permanent link">&para;</a></h3>
<blockquote>
<p>New in 1.20.0</p>
</blockquote>
<p>Used when building an <a href="https://docs.aws.amazon.com/appsync/latest/devguide/security-authz.html#aws-lambda-authorization" target="_blank">AWS_LAMBDA Authorization</a> with AppSync.
See blog post <a href="https://aws.amazon.com/blogs/mobile/appsync-lambda-auth/" target="_blank">Introducing Lambda authorization for AWS AppSync GraphQL APIs</a>
or read the Amplify documentation on using <a href="https://docs.amplify.aws/lib/graphqlapi/authz/q/platform/js#aws-lambda" target="_blank">AWS Lambda for authorization</a> with AppSync.</p>
<p>In this example extract the <code>requestId</code> as the <code>correlation_id</code> for logging, used <code>@event_source</code> decorator and builds the AppSync authorizer using the <code>AppSyncAuthorizerResponse</code> helper.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:1"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>

<span class="kn">from</span> <span class="nn">aws_lambda_powertools.logging</span> <span class="kn">import</span> <span class="n">correlation_paths</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.logging.logger</span> <span class="kn">import</span> <span class="n">Logger</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.appsync_authorizer_event</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AppSyncAuthorizerEvent</span><span class="p">,</span>
    <span class="n">AppSyncAuthorizerResponse</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.event_source</span> <span class="kn">import</span> <span class="n">event_source</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">get_user_by_token</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Look a user by token&quot;&quot;&quot;</span>
    <span class="o">...</span>


<span class="nd">@logger</span><span class="o">.</span><span class="n">inject_lambda_context</span><span class="p">(</span><span class="n">correlation_id_path</span><span class="o">=</span><span class="n">correlation_paths</span><span class="o">.</span><span class="n">APPSYNC_AUTHORIZER</span><span class="p">)</span>
<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">AppSyncAuthorizerEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">AppSyncAuthorizerEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">get_user_by_token</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">authorization_token</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
        <span class="c1"># No user found, return not authorized</span>
        <span class="k">return</span> <span class="n">AppSyncAuthorizerResponse</span><span class="p">()</span><span class="o">.</span><span class="n">asdict</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">AppSyncAuthorizerResponse</span><span class="p">(</span>
        <span class="n">authorize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">resolver_context</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">},</span>
        <span class="c1"># Only allow admins to delete events</span>
        <span class="n">deny_fields</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">is_admin</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;Mutation.deleteEvent&quot;</span><span class="p">],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">asdict</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="appsync-resolver">AppSync Resolver<a class="headerlink" href="#appsync-resolver" title="Permanent link">&para;</a></h3>
<blockquote>
<p>New in 1.12.0</p>
</blockquote>
<p>Used when building Lambda GraphQL Resolvers with <a href="https://docs.amplify.aws/cli/graphql-transformer/function" target="_blank">Amplify GraphQL Transform Library</a> (<code>@function</code>),
and <a href="https://aws.amazon.com/blogs/mobile/appsync-direct-lambda/" target="_blank">AppSync Direct Lambda Resolvers</a>.</p>
<p>In this example, we also use the new Logger <code>correlation_id</code> and built-in <code>correlation_paths</code> to extract, if available, X-Ray Trace ID in AppSync request headers:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:3"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><input id="__tabbed_11_3" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">app.py</label><label for="__tabbed_11_2">Example AppSync Event</label><label for="__tabbed_11_3">Example CloudWatch Log</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.logging</span> <span class="kn">import</span> <span class="n">Logger</span><span class="p">,</span> <span class="n">correlation_paths</span>
<span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.appsync_resolver_event</span> <span class="kn">import</span> <span class="p">(</span>
</span><span class="hll">    <span class="n">AppSyncResolverEvent</span><span class="p">,</span>
</span><span class="hll">    <span class="n">AppSyncIdentityCognito</span>
</span><span class="hll"><span class="p">)</span>
</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">get_locations</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Your resolver logic here&quot;&quot;&quot;</span>

<span class="hll"><span class="nd">@logger</span><span class="o">.</span><span class="n">inject_lambda_context</span><span class="p">(</span><span class="n">correlation_id_path</span><span class="o">=</span><span class="n">correlation_paths</span><span class="o">.</span><span class="n">APPSYNC_RESOLVER</span><span class="p">)</span>
</span><span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="hll">    <span class="n">event</span><span class="p">:</span> <span class="n">AppSyncResolverEvent</span> <span class="o">=</span> <span class="n">AppSyncResolverEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span>
    <span class="c1"># Case insensitive look up of request headers</span>
    <span class="n">x_forwarded_for</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get_header_value</span><span class="p">(</span><span class="s2">&quot;x-forwarded-for&quot;</span><span class="p">)</span>

<span class="hll">    <span class="c1"># Support for AppSyncIdentityCognito or AppSyncIdentityIAM identity types</span>
</span>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span> <span class="n">AppSyncIdentityCognito</span><span class="p">)</span>
<span class="hll">    <span class="n">identity</span><span class="p">:</span> <span class="n">AppSyncIdentityCognito</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">identity</span>
</span>
    <span class="c1"># Logging with correlation_id</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">({</span>
        <span class="s2">&quot;x-forwarded-for&quot;</span><span class="p">:</span> <span class="n">x_forwarded_for</span><span class="p">,</span>
        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="n">identity</span><span class="o">.</span><span class="n">username</span>
    <span class="p">})</span>

<span class="hll">    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type_name</span> <span class="o">==</span> <span class="s2">&quot;Merchant&quot;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">field_name</span> <span class="o">==</span> <span class="s2">&quot;locations&quot;</span><span class="p">:</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">get_locations</span><span class="p">(</span><span class="o">**</span><span class="n">event</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span>
</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported field resolver: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="hll"><span class="w">  </span><span class="nt">&quot;typeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Merchant&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">  </span><span class="nt">&quot;fieldName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;locations&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">  </span><span class="nt">&quot;arguments&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">    </span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
</span><span class="hll"><span class="w">    </span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span><span class="hll"><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span>
</span><span class="hll"><span class="w">  </span><span class="p">},</span>
</span><span class="w">  </span><span class="nt">&quot;identity&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;claims&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;iat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1615366261</span>
<span class="w">      </span><span class="err">...</span>
<span class="w">    </span><span class="p">},</span>
<span class="hll"><span class="w">    </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mike&quot;</span><span class="p">,</span>
</span><span class="w">    </span><span class="err">...</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;headers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">      </span><span class="nt">&quot;x-amzn-trace-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Root=1-60488877-0b0c4e6727ab2a1c545babd0&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">      </span><span class="nt">&quot;x-forwarded-for&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;127.0.0.1&quot;</span>
</span><span class="w">      </span><span class="err">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="err">...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="s2">&quot;lambda_handler:22&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:{</span>
<span class="hll"><span class="w">        </span><span class="nt">&quot;x-forwarded-for&quot;</span><span class="p">:</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">        </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="s2">&quot;mike&quot;</span>
</span><span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="s2">&quot;2021-03-10 12:38:40,062&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;service&quot;</span><span class="p">:</span><span class="s2">&quot;service_undefined&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;sampling_rate&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;cold_start&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;function_name&quot;</span><span class="p">:</span><span class="s2">&quot;func_name&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;function_memory_size&quot;</span><span class="p">:</span><span class="mi">512</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;function_arn&quot;</span><span class="p">:</span><span class="s2">&quot;func_arn&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;function_request_id&quot;</span><span class="p">:</span><span class="s2">&quot;6735a29c-c000-4ae3-94e6-1f1c934f7f94&quot;</span><span class="p">,</span>
<span class="hll"><span class="w">    </span><span class="nt">&quot;correlation_id&quot;</span><span class="p">:</span><span class="s2">&quot;Root=1-60488877-0b0c4e6727ab2a1c545babd0&quot;</span>
</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="aws-config-rule">AWS Config Rule<a class="headerlink" href="#aws-config-rule" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="12:4"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><input id="__tabbed_12_3" name="__tabbed_12" type="radio" /><input id="__tabbed_12_4" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">aws_config_rule.py</label><label for="__tabbed_12_2">Event - ItemChanged</label><label for="__tabbed_12_3">Event - Oversized</label><label for="__tabbed_12_4">Event - ScheduledNotification</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools</span> <span class="kn">import</span> <span class="n">Logger</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="p">(</span>
<span class="hll">    <span class="n">AWSConfigRuleEvent</span><span class="p">,</span>
</span>    <span class="n">event_source</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.typing</span> <span class="kn">import</span> <span class="n">LambdaContext</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">()</span>


<span class="hll"><span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">AWSConfigRuleEvent</span><span class="p">)</span>
</span><span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">AWSConfigRuleEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">LambdaContext</span><span class="p">):</span>
    <span class="n">message_type</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">invoking_event</span><span class="o">.</span><span class="n">message_type</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Logging </span><span class="si">{</span><span class="n">message_type</span><span class="si">}</span><span class="s2"> event rule&quot;</span><span class="p">,</span> <span class="n">invoke_event</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">raw_invoking_event</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;Success&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;invokingEvent&quot;</span><span class="p">:</span><span class="s2">&quot;{\&quot;configurationItemDiff\&quot;:{\&quot;changedProperties\&quot;:{\&quot;Configuration.InstanceType\&quot;:{\&quot;previousValue\&quot;:\&quot;t2.micro\&quot;,\&quot;updatedValue\&quot;:\&quot;t2.medium\&quot;,\&quot;changeType\&quot;:\&quot;UPDATE\&quot;},\&quot;Configuration.State.Name\&quot;:{\&quot;previousValue\&quot;:\&quot;running\&quot;,\&quot;updatedValue\&quot;:\&quot;stopped\&quot;,\&quot;changeType\&quot;:\&quot;UPDATE\&quot;},\&quot;Configuration.StateTransitionReason\&quot;:{\&quot;previousValue\&quot;:\&quot;\&quot;,\&quot;updatedValue\&quot;:\&quot;User initiated (2023-04-27 15:01:07 GMT)\&quot;,\&quot;changeType\&quot;:\&quot;UPDATE\&quot;},\&quot;Configuration.StateReason\&quot;:{\&quot;previousValue\&quot;:null,\&quot;updatedValue\&quot;:{\&quot;code\&quot;:\&quot;Client.UserInitiatedShutdown\&quot;,\&quot;message\&quot;:\&quot;Client.UserInitiatedShutdown: User initiated shutdown\&quot;},\&quot;changeType\&quot;:\&quot;CREATE\&quot;},\&quot;Configuration.CpuOptions.CoreCount\&quot;:{\&quot;previousValue\&quot;:1,\&quot;updatedValue\&quot;:2,\&quot;changeType\&quot;:\&quot;UPDATE\&quot;}},\&quot;changeType\&quot;:\&quot;UPDATE\&quot;},\&quot;configurationItem\&quot;:{\&quot;relatedEvents\&quot;:[],\&quot;relationships\&quot;:[{\&quot;resourceId\&quot;:\&quot;eipalloc-0ebb4367662263cc1\&quot;,\&quot;resourceName\&quot;:null,\&quot;resourceType\&quot;:\&quot;AWS::EC2::EIP\&quot;,\&quot;name\&quot;:\&quot;Is attached to ElasticIp\&quot;},{\&quot;resourceId\&quot;:\&quot;eni-034dd31c4b17ada8c\&quot;,\&quot;resourceName\&quot;:null,\&quot;resourceType\&quot;:\&quot;AWS::EC2::NetworkInterface\&quot;,\&quot;name\&quot;:\&quot;Contains NetworkInterface\&quot;},{\&quot;resourceId\&quot;:\&quot;eni-09a604c0ec356b06f\&quot;,\&quot;resourceName\&quot;:null,\&quot;resourceType\&quot;:\&quot;AWS::EC2::NetworkInterface\&quot;,\&quot;name\&quot;:\&quot;Contains NetworkInterface\&quot;},{\&quot;resourceId\&quot;:\&quot;sg-0fb295a327d9b4835\&quot;,\&quot;resourceName\&quot;:null,\&quot;resourceType\&quot;:\&quot;AWS::EC2::SecurityGroup\&quot;,\&quot;name\&quot;:\&quot;Is associated with SecurityGroup\&quot;},{\&quot;resourceId\&quot;:\&quot;subnet-cad1f2f4\&quot;,\&quot;resourceName\&quot;:null,\&quot;resourceType\&quot;:\&quot;AWS::EC2::Subnet\&quot;,\&quot;name\&quot;:\&quot;Is contained in Subnet\&quot;},{\&quot;resourceId\&quot;:\&quot;vol-0a288b5eb9fea4b30\&quot;,\&quot;resourceName\&quot;:null,\&quot;resourceType\&quot;:\&quot;AWS::EC2::Volume\&quot;,\&quot;name\&quot;:\&quot;Is attached to Volume\&quot;},{\&quot;resourceId\&quot;:\&quot;vpc-2d96be57\&quot;,\&quot;resourceName\&quot;:null,\&quot;resourceType\&quot;:\&quot;AWS::EC2::VPC\&quot;,\&quot;name\&quot;:\&quot;Is contained in Vpc\&quot;}],\&quot;configuration\&quot;:{\&quot;amiLaunchIndex\&quot;:0,\&quot;imageId\&quot;:\&quot;ami-09d95fab7fff3776c\&quot;,\&quot;instanceId\&quot;:\&quot;i-042dd005362091826\&quot;,\&quot;instanceType\&quot;:\&quot;t2.medium\&quot;,\&quot;kernelId\&quot;:null,\&quot;keyName\&quot;:\&quot;mihaec2\&quot;,\&quot;launchTime\&quot;:\&quot;2023-04-27T14:57:16.000Z\&quot;,\&quot;monitoring\&quot;:{\&quot;state\&quot;:\&quot;disabled\&quot;},\&quot;placement\&quot;:{\&quot;availabilityZone\&quot;:\&quot;us-east-1e\&quot;,\&quot;affinity\&quot;:null,\&quot;groupName\&quot;:\&quot;\&quot;,\&quot;partitionNumber\&quot;:null,\&quot;hostId\&quot;:null,\&quot;tenancy\&quot;:\&quot;default\&quot;,\&quot;spreadDomain\&quot;:null,\&quot;hostResourceGroupArn\&quot;:null},\&quot;platform\&quot;:null,\&quot;privateDnsName\&quot;:\&quot;ip-172-31-78-41.ec2.internal\&quot;,\&quot;privateIpAddress\&quot;:\&quot;172.31.78.41\&quot;,\&quot;productCodes\&quot;:[],\&quot;publicDnsName\&quot;:\&quot;ec2-3-232-229-57.compute-1.amazonaws.com\&quot;,\&quot;publicIpAddress\&quot;:\&quot;3.232.229.57\&quot;,\&quot;ramdiskId\&quot;:null,\&quot;state\&quot;:{\&quot;code\&quot;:80,\&quot;name\&quot;:\&quot;stopped\&quot;},\&quot;stateTransitionReason\&quot;:\&quot;User initiated (2023-04-27 15:01:07 GMT)\&quot;,\&quot;subnetId\&quot;:\&quot;subnet-cad1f2f4\&quot;,\&quot;vpcId\&quot;:\&quot;vpc-2d96be57\&quot;,\&quot;architecture\&quot;:\&quot;x86_64\&quot;,\&quot;blockDeviceMappings\&quot;:[{\&quot;deviceName\&quot;:\&quot;/dev/xvda\&quot;,\&quot;ebs\&quot;:{\&quot;attachTime\&quot;:\&quot;2020-05-30T15:21:58.000Z\&quot;,\&quot;deleteOnTermination\&quot;:true,\&quot;status\&quot;:\&quot;attached\&quot;,\&quot;volumeId\&quot;:\&quot;vol-0a288b5eb9fea4b30\&quot;}}],\&quot;clientToken\&quot;:\&quot;\&quot;,\&quot;ebsOptimized\&quot;:false,\&quot;enaSupport\&quot;:true,\&quot;hypervisor\&quot;:\&quot;xen\&quot;,\&quot;iamInstanceProfile\&quot;:{\&quot;arn\&quot;:\&quot;arn:aws:iam::0123456789012:instance-profile/AmazonSSMRoleForInstancesQuickSetup\&quot;,\&quot;id\&quot;:\&quot;AIPAS5S4WFUBL72S3QXW5\&quot;},\&quot;instanceLifecycle\&quot;:null,\&quot;elasticGpuAssociations\&quot;:[],\&quot;elasticInferenceAcceleratorAssociations\&quot;:[],\&quot;networkInterfaces\&quot;:[{\&quot;association\&quot;:{\&quot;carrierIp\&quot;:null,\&quot;ipOwnerId\&quot;:\&quot;0123456789012\&quot;,\&quot;publicDnsName\&quot;:\&quot;ec2-3-232-229-57.compute-1.amazonaws.com\&quot;,\&quot;publicIp\&quot;:\&quot;3.232.229.57\&quot;},\&quot;attachment\&quot;:{\&quot;attachTime\&quot;:\&quot;2020-05-30T15:21:57.000Z\&quot;,\&quot;attachmentId\&quot;:\&quot;eni-attach-0a7e75dc9c1c291a0\&quot;,\&quot;deleteOnTermination\&quot;:true,\&quot;deviceIndex\&quot;:0,\&quot;status\&quot;:\&quot;attached\&quot;,\&quot;networkCardIndex\&quot;:0},\&quot;description\&quot;:\&quot;\&quot;,\&quot;groups\&quot;:[{\&quot;groupName\&quot;:\&quot;minhaec2\&quot;,\&quot;groupId\&quot;:\&quot;sg-0fb295a327d9b4835\&quot;}],\&quot;ipv6Addresses\&quot;:[],\&quot;macAddress\&quot;:\&quot;06:cf:00:c2:17:db\&quot;,\&quot;networkInterfaceId\&quot;:\&quot;eni-034dd31c4b17ada8c\&quot;,\&quot;ownerId\&quot;:\&quot;0123456789012\&quot;,\&quot;privateDnsName\&quot;:\&quot;ip-172-31-78-41.ec2.internal\&quot;,\&quot;privateIpAddress\&quot;:\&quot;172.31.78.41\&quot;,\&quot;privateIpAddresses\&quot;:[{\&quot;association\&quot;:{\&quot;carrierIp\&quot;:null,\&quot;ipOwnerId\&quot;:\&quot;0123456789012\&quot;,\&quot;publicDnsName\&quot;:\&quot;ec2-3-232-229-57.compute-1.amazonaws.com\&quot;,\&quot;publicIp\&quot;:\&quot;3.232.229.57\&quot;},\&quot;primary\&quot;:true,\&quot;privateDnsName\&quot;:\&quot;ip-172-31-78-41.ec2.internal\&quot;,\&quot;privateIpAddress\&quot;:\&quot;172.31.78.41\&quot;}],\&quot;sourceDestCheck\&quot;:true,\&quot;status\&quot;:\&quot;in-use\&quot;,\&quot;subnetId\&quot;:\&quot;subnet-cad1f2f4\&quot;,\&quot;vpcId\&quot;:\&quot;vpc-2d96be57\&quot;,\&quot;interfaceType\&quot;:\&quot;interface\&quot;},{\&quot;association\&quot;:null,\&quot;attachment\&quot;:{\&quot;attachTime\&quot;:\&quot;2020-11-26T23:46:04.000Z\&quot;,\&quot;attachmentId\&quot;:\&quot;eni-attach-0e6d150ebbd19966e\&quot;,\&quot;deleteOnTermination\&quot;:false,\&quot;deviceIndex\&quot;:1,\&quot;status\&quot;:\&quot;attached\&quot;,\&quot;networkCardIndex\&quot;:0},\&quot;description\&quot;:\&quot;MINHAEC2AAAAAA\&quot;,\&quot;groups\&quot;:[{\&quot;groupName\&quot;:\&quot;minhaec2\&quot;,\&quot;groupId\&quot;:\&quot;sg-0fb295a327d9b4835\&quot;},{\&quot;groupName\&quot;:\&quot;default\&quot;,\&quot;groupId\&quot;:\&quot;sg-88105fa0\&quot;}],\&quot;ipv6Addresses\&quot;:[],\&quot;macAddress\&quot;:\&quot;06:0a:62:00:64:5f\&quot;,\&quot;networkInterfaceId\&quot;:\&quot;eni-09a604c0ec356b06f\&quot;,\&quot;ownerId\&quot;:\&quot;0123456789012\&quot;,\&quot;privateDnsName\&quot;:\&quot;ip-172-31-70-9.ec2.internal\&quot;,\&quot;privateIpAddress\&quot;:\&quot;172.31.70.9\&quot;,\&quot;privateIpAddresses\&quot;:[{\&quot;association\&quot;:null,\&quot;primary\&quot;:true,\&quot;privateDnsName\&quot;:\&quot;ip-172-31-70-9.ec2.internal\&quot;,\&quot;privateIpAddress\&quot;:\&quot;172.31.70.9\&quot;}],\&quot;sourceDestCheck\&quot;:true,\&quot;status\&quot;:\&quot;in-use\&quot;,\&quot;subnetId\&quot;:\&quot;subnet-cad1f2f4\&quot;,\&quot;vpcId\&quot;:\&quot;vpc-2d96be57\&quot;,\&quot;interfaceType\&quot;:\&quot;interface\&quot;}],\&quot;outpostArn\&quot;:null,\&quot;rootDeviceName\&quot;:\&quot;/dev/xvda\&quot;,\&quot;rootDeviceType\&quot;:\&quot;ebs\&quot;,\&quot;securityGroups\&quot;:[{\&quot;groupName\&quot;:\&quot;minhaec2\&quot;,\&quot;groupId\&quot;:\&quot;sg-0fb295a327d9b4835\&quot;}],\&quot;sourceDestCheck\&quot;:true,\&quot;spotInstanceRequestId\&quot;:null,\&quot;sriovNetSupport\&quot;:null,\&quot;stateReason\&quot;:{\&quot;code\&quot;:\&quot;Client.UserInitiatedShutdown\&quot;,\&quot;message\&quot;:\&quot;Client.UserInitiatedShutdown: User initiated shutdown\&quot;},\&quot;tags\&quot;:[{\&quot;key\&quot;:\&quot;projeto\&quot;,\&quot;value\&quot;:\&quot;meetup\&quot;},{\&quot;key\&quot;:\&quot;Name\&quot;,\&quot;value\&quot;:\&quot;Minha\&quot;},{\&quot;key\&quot;:\&quot;CentroCusto\&quot;,\&quot;value\&quot;:\&quot;TI\&quot;},{\&quot;key\&quot;:\&quot;Setor\&quot;,\&quot;value\&quot;:\&quot;Desenvolvimento\&quot;}],\&quot;virtualizationType\&quot;:\&quot;hvm\&quot;,\&quot;cpuOptions\&quot;:{\&quot;coreCount\&quot;:2,\&quot;threadsPerCore\&quot;:1},\&quot;capacityReservationId\&quot;:null,\&quot;capacityReservationSpecification\&quot;:{\&quot;capacityReservationPreference\&quot;:\&quot;open\&quot;,\&quot;capacityReservationTarget\&quot;:null},\&quot;hibernationOptions\&quot;:{\&quot;configured\&quot;:false},\&quot;licenses\&quot;:[],\&quot;metadataOptions\&quot;:{\&quot;state\&quot;:\&quot;applied\&quot;,\&quot;httpTokens\&quot;:\&quot;optional\&quot;,\&quot;httpPutResponseHopLimit\&quot;:1,\&quot;httpEndpoint\&quot;:\&quot;enabled\&quot;},\&quot;enclaveOptions\&quot;:{\&quot;enabled\&quot;:false},\&quot;bootMode\&quot;:null},\&quot;supplementaryConfiguration\&quot;:{},\&quot;tags\&quot;:{\&quot;projeto\&quot;:\&quot;meetup\&quot;,\&quot;Setor\&quot;:\&quot;Desenvolvimento\&quot;,\&quot;CentroCusto\&quot;:\&quot;TI\&quot;,\&quot;Name\&quot;:\&quot;Minha\&quot;},\&quot;configurationItemVersion\&quot;:\&quot;1.3\&quot;,\&quot;configurationItemCaptureTime\&quot;:\&quot;2023-04-27T15:03:11.636Z\&quot;,\&quot;configurationStateId\&quot;:1682607791636,\&quot;awsAccountId\&quot;:\&quot;0123456789012\&quot;,\&quot;configurationItemStatus\&quot;:\&quot;OK\&quot;,\&quot;resourceType\&quot;:\&quot;AWS::EC2::Instance\&quot;,\&quot;resourceId\&quot;:\&quot;i-042dd005362091826\&quot;,\&quot;resourceName\&quot;:null,\&quot;ARN\&quot;:\&quot;arn:aws:ec2:us-east-1:0123456789012:instance/i-042dd005362091826\&quot;,\&quot;awsRegion\&quot;:\&quot;us-east-1\&quot;,\&quot;availabilityZone\&quot;:\&quot;us-east-1e\&quot;,\&quot;configurationStateMd5Hash\&quot;:\&quot;\&quot;,\&quot;resourceCreationTime\&quot;:\&quot;2023-04-27T14:57:16.000Z\&quot;},\&quot;notificationCreationTime\&quot;:\&quot;2023-04-27T15:03:13.332Z\&quot;,\&quot;messageType\&quot;:\&quot;ConfigurationItemChangeNotification\&quot;,\&quot;recordVersion\&quot;:\&quot;1.3\&quot;}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ruleParameters&quot;</span><span class="p">:</span><span class="s2">&quot;{\&quot;desiredInstanceType\&quot;: \&quot;t2.micro\&quot;}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;resultToken&quot;</span><span class="p">:</span><span class="s2">&quot;eyJlbmNyeXB0ZWREYXRhIjpbLTQxLDEsLTU3LC0zMCwtMTIxLDUzLDUyLDQ1LC01NywtOCw3MywtODEsLTExNiwtMTAyLC01MiwxMTIsLTQ3LDU4LDY1LC0xMjcsMTAyLDUsLTY5LDQ0LC0xNSwxMTQsNDEsLTksMTExLC0zMCw2NSwtNzUsLTM1LDU0LDEwNSwtODksODYsNDAsLTEwNSw5OCw2NSwtMTE5LC02OSwyNCw2NiwtMjAsODAsLTExMiwtNzgsLTgwLDQzLC01NywzMCwtMjUsODIsLTEwLDMsLTQsLTg1LC01MywtMzcsLTkwLC04OCwtOTgsLTk4LC00MSwxOSwxMTYsNjIsLTIzLC0xMjEsLTEwOCw1NywtNTgsLTUyLDI5LDEwMSwxMjIsLTU2LC03MSwtODEsLTQ3LDc3LC0yMiwtMTI0LC0zLC04NiwtMTIyLC00MCwtODksLTEwMSw1NywtMTI3LC0zNywtMzcsLTMxLC05OCwtMzEsMTEsLTEyNSwwLDEwOCwtMzIsNjQsNjIsLTIyLDAsNDcsLTEwNiwtMTAwLDEwNCwxNCw1OCwxMjIsLTEwLC01MCwtOTAsLTgwLC01MCwtNSw2NSwwLC0yNSw4NSw4Miw3LDkzLDEyMiwtODIsLTExNiwtNzksLTQ0LDcyLC03MywtNjksMTQsLTU2LDk0LDkwLDExNCwtMjksLTExOSwtNzEsODgsMTA3LDEwNywxMTAsLTcsMTI3LC0xMjUsLTU3LC0xMjYsLTEyMCw2OSwtMTI3LC03NiwtMTE5LDcxLDEsLTY4LDEwNywxMTMsLTU2LDg3LC0xMDIsLTE2LDEwOCwtMTA3LC00MywtOTQsLTEwNiwzLDkwLDE0LDcyLC0xMiwtMTE2LC03Myw4MCwtMTIyLDQ0LC0xMDQsMTIsNzQsNTcsLTEwLC0xMDUsLTExMiwtMzYsMjgsLTQ1LDk3LDExLC00OSwtMTEsNjEsMzYsLTE3LC03NCw1MCw0LC0yNiwxMDQsLTI4LC0xMjUsMjQsNzAsLTg1LC00Niw5MiwtMTAzLC00MSwtMTA2LDY5LDEyMiwyMSwtMjUsODAsOTksLTkzLC01NiwtMjUsLTQ3LC0xMjMsLTU5LC0xMjQsLTUyLC0xNiwxMjcsLTM4LC0xNiwxMDEsMTE5LDEwNywyNywxMCwtNDYsLTg3LC0xMiwtMzksMTQsNDUsMiw3MCwxMDcsMTA0LC00LC02OSwtMTIsNTksLTEyNiwtOTEsMTI3LDU0LDEwNiwtMTI2LC0xMTYsLTEwMiw3Miw4MSw1MCw3NSwtNTEsMTA4LDQxLC0zLC02LC00NSwxMDMsLTg2LDM3LC00NiwtMzIsLTExMSwxMjQsMTExLDg3LDU0LC03NiwxMjIsLTUsLTM2LC04OCw5LC0xMTMsMTE2LC01OSw4Myw3NywyOCwxMiwtNjUsLTExMywtNzksLTEyOCw4MiwtMTE4LC04MywtMTI0LDMxLDk5LC05MCwtOTksMTYsLTEyMywyMSwtMTE0LC05OCwtMTE2LC0xMTksMiwtNzMsNDYsODIsLTEzLDU0LDcxLC00MiwyNSw3NCw3MywtODYsOTQsNDYsOTksOTMsLTgyLDU1LDY1LC05OCw0OSwtNjAsMTEyLDEwMSwyMiw2OSwtMTYsNzcsLTk0LC01OSwtNDYsMTE1LDMwLC00Myw5Myw4OCwtMjgsMzgsNiw4NCwzMSwtMTAxLDMyLC0yMiwtNjMsLTk1LDExNCwtNzUsMTE0LDM2LC04NCw0MCwtNDQsLTEzLDU5LDcyLC0xLC0xMDMsMzEsMTA1LDY5LDY5LDc3LC02NCwtNTYsMTE4LDEzLC0xMTQsODAsOTksLTUzLDI1LDQyLDk0LDczLC04MCwyNSwzOCwyNCwtMTcsNjYsLTExOCwtMjMsMTE5LDkwLDEyMSwxMTgsLTUxLDUxLC0xMiwtNzYsLTUxLDksLTIxLDExNCwtMzcsLTY0LC0yLC0xMjYsLTk1LDYzLDczLC00MSwtMzQsLTkwLC0yMiw1OSwtNzksMzAsLTQsLTEsLTUsMTIsMzksLTk5LC0xMDUsLTEwNCwtNjEsNjUsLTc0LDE5LC0xMywtNjAsLTI4LC04LDQsLTgsMTIxLC0xMTgsMTIyLC02NSwtMjEsMjMsMTcsLTg0LDQwLC05MiwxNCwtMTI2LC02MCwtNzksLTUzLDM3LC04Myw2NSwxMDQsLTM2LC02MCwtMTEwLC0zMywtMTE3LDYsMTA3LDEsLTMsOTMsNzgsLTk1LC0xMjIsNTMsMTA4LC00OSwtNDksMjQsLTY1LDgzLDEyNSwtNzcsLTE5LC04MSwzNCwtNjcsLTQzLC03MCwtMjYsMTgsMTA0LDY1LDQsLTEyNiw0NCwtMTE5LDUyLC00NiwyMiw2NywxMTMsMTE4LC0zMywzNCwtOTYsMTIxLDE5LC0yLC0zNSwwLC04MiwxNyw2NiwtMjcsNjksLTM2LC0xNCw1NiwtOTcsLTE2LDEyMywyOCwtOTUsLTMyLC02MywtNjksNzAsNjQsLTMzLC0xMDAsNDMsLTExMywxMDUsMTAwLDEwOCwtNjAsNDAsLTIsLTk2LC0xMjQsMzcsLTQ1LC0xMjQsLTY4LC02OSwtMTIzLDE3LC02LDg2LC01OSwtOTQsMTEwLDczLDU3LC0xMTYsMTA3LC00MSwtOTQsLTExOCwtMTI2LDEwLC04MCwtNzAsMTAyLDg4LC0xMjYsODcsLTI3LC0xMDEsLTk0LC0zNSwtMTA2LC02LC03MiwtODYsNTAsMTE2LC0yOCw5MCwxMywtMTIwLDYsMjcsOTIsNTYsLTkwLDM5LDQ5LC0xMywtODYsLTI1LC04NiwxMTMsLTEzLDQxLC0xMTksOTQsLTk0LC0xMDMsLTgzLC02MCwxMjcsLTE1LC0zOSwxMTksLTk1LDI3LDQ0LDExNiwxMDksNywtMTAyLC0xNyw0OCwtODIsLTMxLC04LC02OSwzNSw5NCw1NCwtNTUsMSwtMTE5LDU3LC0xMDgsLTMsLTkxLC0xMjIsLTUzLC04OCw0LC05NywtMzUsMTI2LDExOSw1OSwtMSw4NSw3MywtNTgsLTEyMCwtNjQsMTE5LC0xMTIsOTIsMTksOSwtNjYsLTkyLDEwOCwtMTEsLTQyLDExMSwtMTA0LC0xMjAsMjcsLTEwMywtNjksMTksMTExLDEyLDIzLDEwNyw1NCw0MSwtMjYsNjAsLTMxLC01XSwibWF0ZXJpYWxTZXRTZXJpYWxOdW1iZXIiOjEsIml2UGFyYW1ldGVyU3BlYyI6eyJpdiI6Wy05NSwzMiwxMDgsOTEsMzUsLTgyLC0zNywyNCwtNDQsLTExNSwtODIsLTEyOCwtMTIyLDMsNTMsLTI0XX19&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;eventLeftScope&quot;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;executionRoleArn&quot;</span><span class="p">:</span><span class="s2">&quot;arn:aws:iam::0123456789012:role/aws-service-role/config.amazonaws.com/AWSServiceRoleForConfig&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;configRuleArn&quot;</span><span class="p">:</span><span class="s2">&quot;arn:aws:config:us-east-1:0123456789012:config-rule/config-rule-i9y8j9&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;configRuleName&quot;</span><span class="p">:</span><span class="s2">&quot;MyRule&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;configRuleId&quot;</span><span class="p">:</span><span class="s2">&quot;config-rule-i9y8j9&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;accountId&quot;</span><span class="p">:</span><span class="s2">&quot;0123456789012&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;evaluationMode&quot;</span><span class="p">:</span><span class="s2">&quot;DETECTIVE&quot;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;invokingEvent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{\&quot;configurationItemSummary\&quot;: {\&quot;changeType\&quot;: \&quot;UPDATE\&quot;,\&quot;configurationItemVersion\&quot;: \&quot;1.2\&quot;,\&quot;configurationItemCaptureTime\&quot;:\&quot;2016-10-06T16:46:16.261Z\&quot;,\&quot;configurationStateId\&quot;: 0,\&quot;awsAccountId\&quot;:\&quot;123456789012\&quot;,\&quot;configurationItemStatus\&quot;: \&quot;OK\&quot;,\&quot;resourceType\&quot;: \&quot;AWS::EC2::Instance\&quot;,\&quot;resourceId\&quot;:\&quot;i-00000000\&quot;,\&quot;resourceName\&quot;:null,\&quot;ARN\&quot;:\&quot;arn:aws:ec2:us-west-2:123456789012:instance/i-00000000\&quot;,\&quot;awsRegion\&quot;: \&quot;us-west-2\&quot;,\&quot;availabilityZone\&quot;:\&quot;us-west-2a\&quot;,\&quot;configurationStateMd5Hash\&quot;:\&quot;8f1ee69b287895a0f8bc5753eca68e96\&quot;,\&quot;resourceCreationTime\&quot;:\&quot;2016-10-06T16:46:10.489Z\&quot;},\&quot;messageType\&quot;:\&quot;OversizedConfigurationItemChangeNotification\&quot;, \&quot;notificationCreationTime\&quot;: \&quot;2016-10-06T16:46:16.261Z\&quot;, \&quot;recordVersion\&quot;: \&quot;1.0\&quot;}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ruleParameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{\&quot;myParameterKey\&quot;:\&quot;myParameterValue\&quot;}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;resultToken&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;myResultToken&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;eventLeftScope&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;executionRoleArn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arn:aws:iam::123456789012:role/config-role&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;configRuleArn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arn:aws:config:us-east-2:123456789012:config-rule/config-rule-ec2-managed-instance-inventory&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;configRuleName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;change-triggered-config-rule&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;configRuleId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;config-rule-0123456&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;accountId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123456789012&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;invokingEvent&quot;</span><span class="p">:</span><span class="s2">&quot;{\&quot;awsAccountId\&quot;:\&quot;0123456789012\&quot;,\&quot;notificationCreationTime\&quot;:\&quot;2023-04-27T13:26:17.741Z\&quot;,\&quot;messageType\&quot;:\&quot;ScheduledNxotification\&quot;,\&quot;recordVersion\&quot;:\&quot;1.0\&quot;}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ruleParameters&quot;</span><span class="p">:</span><span class="s2">&quot;{\&quot;test\&quot;:\&quot;x\&quot;}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;resultToken&quot;</span><span class="p">:</span><span class="s2">&quot;eyJlbmNyeXB0ZWREYXRhIjpbLTQyLDEyNiw1MiwtMzcsLTI5LDExNCwxMjYsLTk3LDcxLDIyLC0xMTAsMTEyLC0zMSwtOTMsLTQ5LC0xMDEsODIsMyw1NCw0OSwzLC02OSwtNzEsLTcyLDYyLDgxLC03MiwtODEsNTAsMzUsLTUwLC03NSwtMTE4LC0xMTgsNzcsMTIsLTEsMTQsMTIwLC03MCwxMTAsLTMsNTAsLTYwLDEwNSwtNTcsNDUsMTAyLC0xMDksLTYxLC0xMDEsLTYxLDQsNDcsLTg0LC0yNSwxMTIsNTQsLTcxLC0xMDksNDUsMTksMTIzLC0yNiwxMiwtOTYsLTczLDU0LC0xMDksOTIsNDgsLTU5LC04MywtMzIsODIsLTM2LC05MCwxOSw5OCw3Nyw3OCw0MCw4MCw3OCwtMTA1LDg3LC0xMTMsLTExNiwtNzIsMzAsLTY4LC00MCwtODksMTA5LC0xMDgsLTEyOCwyMiw3Miw3NywtMjEsNzYsODksOTQsLTU5LDgxLC0xMjEsLTEwNywtNjcsNjMsLTcsODIsLTg5LC00NiwtMzQsLTkyLDEyMiwtOTAsMTcsLTEyMywyMCwtODUsLTU5LC03MCw4MSwyNyw2Miw3NCwtODAsODAsMzcsNDAsMTE2LDkxLC0yNCw1MSwtNDEsLTc5LDI4LDEyMCw1MywtMTIyLC04MywxMjYsLTc4LDI1LC05OCwtMzYsMTMsMzIsODYsLTI1LDQ4LDMsLTEwMiwtMTYsMjQsLTMsODUsNDQsLTI4LDE0LDIyLDI3LC0xMjIsMTE4LDEwMSw3Myw1LDE4LDU4LC02NCwyMywtODYsLTExNCwyNCwwLDEwMCwyLDExNywtNjIsLTExOSwtMTI4LDE4LDY1LDkwLDE0LC0xMDIsMjEsODUsMTAwLDExNyw1NSwyOSwxMjcsNTQsNzcsNzIsNzQsMzIsNzgsMywtMTExLDExOCwtNzAsLTg2LDEyNywtNzQsNjAsMjIsNDgsMzcsODcsMTMsMCwtMTA1LDUsLTEyMiwtNzEsLTEwMCwxMDQsLTEyNiwtMTYsNzksLTMwLDEyMCw3NywtNzYsLTQxLC0xMDksMiw5NywtMTAxLC0xLDE1LDEyMywxMTksMTA4LDkxLC0yMCwtMTI1LC05NiwyLC05MiwtMTUsLTY3LC03NiwxMjEsMTA0LDEwNSw2NCwtNjIsMTAyLDgsNCwxMjEsLTQ1LC04MCwtODEsLTgsMTE4LDQ0LC04MiwtNDEsLTg0LDczLC0zNiwxMTcsODAsLTY5LC03MywxNCwtMTgsNzIsMzEsLTUsLTExMSwtMTI3LC00MywzNCwtOCw1NywxMDMsLTQyLDE4LC0zMywxMTcsLTI2LC0xMjQsLTEyNCwxNSw4OCwyMywxNiwtNTcsNTQsLTYsLTEwMiwxMTYsLTk5LC00NSwxMDAsLTM1LDg3LDM3LDYsOTgsMiwxMTIsNjAsLTMzLDE3LDI2LDk5LC0xMDUsNDgsLTEwNCwtMTE5LDc4LDYsLTU4LDk1LDksNDEsLTE2LDk2LDQxLC0yMiw5Niw3MiwxMTYsLTk1LC0xMDUsLTM2LC0xMjMsLTU1LDkxLC00NiwtNywtOTIsMzksNDUsODQsMTYsLTEyNCwtMTIyLC02OCwxLC0yOCwxMjIsLTYwLDgyLDEwMywtNTQsLTkyLDI3LC05OSwtMTI4LDY1LDcsLTcyLC0xMjcsNjIsLTIyLDIsLTExLDE4LC04OSwtMTA2LC03NCw3MSw4NiwtMTE2LC0yNSwtMTE1LC05Niw1NywtMzQsMjIsLTEyNCwtMTI1LC00LC00MSw0MiwtNTcsLTEwMyw0NSw3OCwxNCwtMTA2LDExMSw5OCwtOTQsLTcxLDUsNzUsMTksLTEyNCwtMzAsMzQsLTUwLDc1LC04NCwtNTAsLTU2LDUxLC0xNSwtMzYsNjEsLTk0LC03OSwtNDUsMTI2LC03NywtMTA1LC0yLC05MywtNiw4LC0zLDYsLTQyLDQ2LDEyNSw1LC05OCwxMyw2NywtMTAsLTEzLC05NCwtNzgsLTEyNywxMjEsLTI2LC04LC0xMDEsLTkxLDEyMSwtNDAsLTEyNCwtNjQsODQsLTcyLDYzLDE5LC04NF0sIm1hdGVyaWFsU2V0U2VyaWFsTnVtYmVyIjoxLCJpdlBhcmFtZXRlclNwZWMiOnsiaXYiOlszLC0xMCwtODUsMTE0LC05MCwxMTUsNzcsNTUsNTQsMTUsMzgsODQsLTExNiwxNCwtNDAsMjhdfX0=&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;eventLeftScope&quot;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;executionRoleArn&quot;</span><span class="p">:</span><span class="s2">&quot;arn:aws:iam::0123456789012:role/aws-service-role/config.amazonaws.com/AWSServiceRoleForConfig&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;configRuleArn&quot;</span><span class="p">:</span><span class="s2">&quot;arn:aws:config:us-east-1:0123456789012:config-rule/config-rule-pdmyw1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;configRuleName&quot;</span><span class="p">:</span><span class="s2">&quot;rule-ec2-test&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;configRuleId&quot;</span><span class="p">:</span><span class="s2">&quot;config-rule-pdmyw1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;accountId&quot;</span><span class="p">:</span><span class="s2">&quot;0123456789012&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;evaluationMode&quot;</span><span class="p">:</span><span class="s2">&quot;DETECTIVE&quot;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="cloudwatch-dashboard-custom-widget">CloudWatch Dashboard Custom Widget<a class="headerlink" href="#cloudwatch-dashboard-custom-widget" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="13:1"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">CloudWatchDashboardCustomWidgetEvent</span>

<span class="n">const</span> <span class="n">DOCS</span> <span class="o">=</span> <span class="err">`</span>
<span class="c1">## Echo</span>
<span class="n">A</span> <span class="n">simple</span> <span class="n">echo</span> <span class="n">script</span><span class="o">.</span> <span class="n">Anything</span> <span class="n">passed</span> <span class="ow">in</span> \<span class="err">`</span>\<span class="err">`</span>\<span class="err">`</span><span class="n">echo</span>\<span class="err">`</span>\<span class="err">`</span>\<span class="err">`</span> <span class="n">parameter</span> <span class="ow">is</span> <span class="n">returned</span> <span class="k">as</span> <span class="n">the</span> <span class="n">content</span> <span class="n">of</span> <span class="n">custom</span> <span class="n">widget</span><span class="o">.</span>

<span class="c1">### Widget parameters</span>
<span class="o">|</span> <span class="n">Param</span>    <span class="o">|</span> <span class="n">Description</span>              <span class="o">|</span>
<span class="o">|</span> <span class="o">--------</span> <span class="o">|</span> <span class="o">------------------------</span> <span class="o">|</span>
<span class="o">|</span> <span class="o">**</span><span class="n">echo</span><span class="o">**</span> <span class="o">|</span> <span class="n">The</span> <span class="n">content</span> <span class="n">to</span> <span class="n">echo</span> <span class="n">back</span> <span class="o">|</span>

<span class="c1">### Example parameters</span>
\<span class="err">`</span>\<span class="err">`</span>\<span class="err">`</span> <span class="n">yaml</span>
<span class="n">echo</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">Hello</span> <span class="n">world</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
\<span class="err">`</span>\<span class="err">`</span>\<span class="err">`</span>
<span class="err">`</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">CloudWatchDashboardCustomWidgetEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">CloudWatchDashboardCustomWidgetEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">describe</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DOCS</span>

    <span class="c1"># You can directly return HTML or JSON content</span>
    <span class="c1"># Alternatively, you can return markdown that will be rendered by CloudWatch</span>
    <span class="n">echo</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">widget_context</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;echo&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">{</span> <span class="s2">&quot;markdown&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;# </span><span class="si">{</span><span class="n">echo</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="cloudwatch-logs">CloudWatch Logs<a class="headerlink" href="#cloudwatch-logs" title="Permanent link">&para;</a></h3>
<p>CloudWatch Logs events by default are compressed and base64 encoded. You can use the helper function provided to decode,
decompress and parse json data from the event.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:1"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">CloudWatchLogsEvent</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.cloud_watch_logs_event</span> <span class="kn">import</span> <span class="n">CloudWatchLogsDecodedData</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">CloudWatchLogsEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">CloudWatchLogsEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">decompressed_log</span><span class="p">:</span> <span class="n">CloudWatchLogsDecodedData</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">parse_logs_data</span><span class="p">()</span>
    <span class="n">log_events</span> <span class="o">=</span> <span class="n">decompressed_log</span><span class="o">.</span><span class="n">log_events</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">log_events</span><span class="p">:</span>
        <span class="n">do_something_with</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h4 id="kinesis-integration">Kinesis integration<a class="headerlink" href="#kinesis-integration" title="Permanent link">&para;</a></h4>
<p><a href="https://aws.amazon.com/premiumsupport/knowledge-center/streaming-cloudwatch-logs/" target="_blank">When streaming CloudWatch Logs to a Kinesis Data Stream</a> (cross-account or not), you can use <code>extract_cloudwatch_logs_from_event</code> to decode, decompress and extract logs as <code>CloudWatchLogsDecodedData</code> to ease log processing.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:1"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.cloud_watch_logs_event</span> <span class="kn">import</span> <span class="n">CloudWatchLogsDecodedData</span>
<span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.kinesis_stream_event</span> <span class="kn">import</span> <span class="p">(</span>
</span><span class="hll">    <span class="n">KinesisStreamEvent</span><span class="p">,</span> <span class="n">extract_cloudwatch_logs_from_event</span><span class="p">)</span>
</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">KinesisStreamEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">simple_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">KinesisStreamEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="hll">    <span class="n">logs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">CloudWatchLogsDecodedData</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_cloudwatch_logs_from_event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span>    <span class="k">for</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">logs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">log</span><span class="o">.</span><span class="n">message_type</span> <span class="o">==</span> <span class="s2">&quot;DATA_MESSAGE&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;success&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;nothing to be processed&quot;</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<p>Alternatively, you can use <code>extract_cloudwatch_logs_from_record</code> to seamless integrate with the <a href="../batch/" target="_blank">Batch utility</a> for more robust log processing.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:1"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.batch</span> <span class="kn">import</span> <span class="p">(</span><span class="n">BatchProcessor</span><span class="p">,</span> <span class="n">EventType</span><span class="p">,</span>
                                                   <span class="n">batch_processor</span><span class="p">)</span>
<span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.kinesis_stream_event</span> <span class="kn">import</span> <span class="p">(</span>
</span><span class="hll">    <span class="n">KinesisStreamRecord</span><span class="p">,</span> <span class="n">extract_cloudwatch_logs_from_record</span><span class="p">)</span>
</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">BatchProcessor</span><span class="p">(</span><span class="n">event_type</span><span class="o">=</span><span class="n">EventType</span><span class="o">.</span><span class="n">KinesisDataStreams</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">record_handler</span><span class="p">(</span><span class="n">record</span><span class="p">:</span> <span class="n">KinesisStreamRecord</span><span class="p">):</span>
<span class="hll">    <span class="n">log</span> <span class="o">=</span> <span class="n">extract_cloudwatch_logs_from_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="n">log</span><span class="o">.</span><span class="n">message_type</span> <span class="o">==</span> <span class="s2">&quot;DATA_MESSAGE&quot;</span>


<span class="nd">@batch_processor</span><span class="p">(</span><span class="n">record_handler</span><span class="o">=</span><span class="n">record_handler</span><span class="p">,</span> <span class="n">processor</span><span class="o">=</span><span class="n">processor</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">processor</span><span class="o">.</span><span class="n">response</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="codepipeline-job">CodePipeline Job<a class="headerlink" href="#codepipeline-job" title="Permanent link">&para;</a></h3>
<p>Data classes and utility functions to help create continuous delivery pipelines tasks with AWS Lambda</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:1"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools</span> <span class="kn">import</span> <span class="n">Logger</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">CodePipelineJobEvent</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">()</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">CodePipelineJobEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The Lambda function handler</span>

<span class="sd">    If a continuing job then checks the CloudFormation stack status</span>
<span class="sd">    and updates the job accordingly.</span>

<span class="sd">    If a new job then kick of an update or creation of the target</span>
<span class="sd">    CloudFormation stack.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extract the Job ID</span>
    <span class="n">job_id</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get_id</span>

    <span class="c1"># Extract the params</span>
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">decoded_user_parameters</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;stack&quot;</span><span class="p">]</span>
    <span class="n">artifact_name</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;artifact&quot;</span><span class="p">]</span>
    <span class="n">template_file</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">continuation_token</span><span class="p">:</span>
            <span class="c1"># If we&#39;re continuing then the create/update has already been triggered</span>
            <span class="c1"># we just need to check if it has finished.</span>
            <span class="n">check_stack_update_status</span><span class="p">(</span><span class="n">job_id</span><span class="p">,</span> <span class="n">stack</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">template</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get_artifact</span><span class="p">(</span><span class="n">artifact_name</span><span class="p">,</span> <span class="n">template_file</span><span class="p">)</span>
            <span class="c1"># Kick off a stack update or create</span>
            <span class="n">start_update_or_create</span><span class="p">(</span><span class="n">job_id</span><span class="p">,</span> <span class="n">stack</span><span class="p">,</span> <span class="n">template</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If any other exceptions which we didn&#39;t expect are raised</span>
        <span class="c1"># then fail the job and log the exception message.</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Function failed due to exception.&quot;</span><span class="p">)</span>
        <span class="n">put_job_failure</span><span class="p">(</span><span class="n">job_id</span><span class="p">,</span> <span class="s2">&quot;Function exception: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Function complete.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;Complete.&quot;</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="cognito-user-pool">Cognito User Pool<a class="headerlink" href="#cognito-user-pool" title="Permanent link">&para;</a></h3>
<p>Cognito User Pools have several <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-identity-pools-working-with-aws-lambda-triggers.html#cognito-user-identity-pools-working-with-aws-lambda-trigger-sources" target="_blank">different Lambda trigger sources</a>, all of which map to a different data class, which
can be imported from <code>aws_lambda_powertools.data_classes.cognito_user_pool_event</code>:</p>
<table>
<thead>
<tr>
<th>Trigger/Event Source</th>
<th>Data Class</th>
</tr>
</thead>
<tbody>
<tr>
<td>Custom message event</td>
<td><code>data_classes.cognito_user_pool_event.CustomMessageTriggerEvent</code></td>
</tr>
<tr>
<td>Post authentication</td>
<td><code>data_classes.cognito_user_pool_event.PostAuthenticationTriggerEvent</code></td>
</tr>
<tr>
<td>Post confirmation</td>
<td><code>data_classes.cognito_user_pool_event.PostConfirmationTriggerEvent</code></td>
</tr>
<tr>
<td>Pre authentication</td>
<td><code>data_classes.cognito_user_pool_event.PreAuthenticationTriggerEvent</code></td>
</tr>
<tr>
<td>Pre sign-up</td>
<td><code>data_classes.cognito_user_pool_event.PreSignUpTriggerEvent</code></td>
</tr>
<tr>
<td>Pre token generation</td>
<td><code>data_classes.cognito_user_pool_event.PreTokenGenerationTriggerEvent</code></td>
</tr>
<tr>
<td>User migration</td>
<td><code>data_classes.cognito_user_pool_event.UserMigrationTriggerEvent</code></td>
</tr>
<tr>
<td>Define Auth Challenge</td>
<td><code>data_classes.cognito_user_pool_event.DefineAuthChallengeTriggerEvent</code></td>
</tr>
<tr>
<td>Create Auth Challenge</td>
<td><code>data_classes.cognito_user_pool_event.CreateAuthChallengeTriggerEvent</code></td>
</tr>
<tr>
<td>Verify Auth Challenge</td>
<td><code>data_classes.cognito_user_pool_event.VerifyAuthChallengeResponseTriggerEvent</code></td>
</tr>
</tbody>
</table>
<h4 id="post-confirmation-example">Post Confirmation Example<a class="headerlink" href="#post-confirmation-example" title="Permanent link">&para;</a></h4>
<div class="tabbed-set tabbed-alternate" data-tabs="18:1"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.cognito_user_pool_event</span> <span class="kn">import</span> <span class="n">PostConfirmationTriggerEvent</span>

<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">event</span><span class="p">:</span> <span class="n">PostConfirmationTriggerEvent</span> <span class="o">=</span> <span class="n">PostConfirmationTriggerEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="n">user_attributes</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user_attributes</span>
    <span class="n">do_something_with</span><span class="p">(</span><span class="n">user_attributes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h4 id="define-auth-challenge-example">Define Auth Challenge Example<a class="headerlink" href="#define-auth-challenge-example" title="Permanent link">&para;</a></h4>
<details class="note" open="open">
<summary>Note</summary>
<p>In this example we are modifying the wrapped dict response fields, so we need to return the json serializable wrapped event in <code>event.raw_event</code>.</p>
</details>
<p>This example is based on the AWS Cognito docs for <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-define-auth-challenge.html" target="_blank">Define Auth Challenge Lambda Trigger</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:4"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><input id="__tabbed_19_2" name="__tabbed_19" type="radio" /><input id="__tabbed_19_3" name="__tabbed_19" type="radio" /><input id="__tabbed_19_4" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">app.py</label><label for="__tabbed_19_2">SPR_A response</label><label for="__tabbed_19_3">PASSWORD_VERIFIER success response</label><label for="__tabbed_19_4">CUSTOM_CHALLENGE success response</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.cognito_user_pool_event</span> <span class="kn">import</span> <span class="n">DefineAuthChallengeTriggerEvent</span>

<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="n">event</span><span class="p">:</span> <span class="n">DefineAuthChallengeTriggerEvent</span> <span class="o">=</span> <span class="n">DefineAuthChallengeTriggerEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">challenge_name</span> <span class="o">==</span> <span class="s2">&quot;SRP_A&quot;</span>
    <span class="p">):</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">issue_tokens</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">fail_authentication</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">challenge_name</span> <span class="o">=</span> <span class="s2">&quot;PASSWORD_VERIFIER&quot;</span>
    <span class="k">elif</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
        <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">challenge_name</span> <span class="o">==</span> <span class="s2">&quot;PASSWORD_VERIFIER&quot;</span>
        <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">challenge_result</span>
    <span class="p">):</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">issue_tokens</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">fail_authentication</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">challenge_name</span> <span class="o">=</span> <span class="s2">&quot;CUSTOM_CHALLENGE&quot;</span>
    <span class="k">elif</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
        <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">challenge_name</span> <span class="o">==</span> <span class="s2">&quot;CUSTOM_CHALLENGE&quot;</span>
        <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">challenge_result</span>
    <span class="p">):</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">issue_tokens</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">fail_authentication</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">issue_tokens</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">fail_authentication</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">event</span><span class="o">.</span><span class="n">raw_event</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;region&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;us-east-1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;userPoolId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;us-east-1_example&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;userName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UserName&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;callerContext&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;awsSdkVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;awsSdkVersion&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;clientId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;clientId&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;triggerSource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DefineAuthChallenge_Authentication&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;userAttributes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;sub&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4A709A36-7D63-4785-829D-4198EF10EBDA&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;email_verified&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;First Last&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;define-auth@mail.com&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;session&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;challengeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SRP_A&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;challengeResult&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="hll"><span class="w">    </span><span class="nt">&quot;response&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">        </span><span class="nt">&quot;issueTokens&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span class="hll"><span class="w">        </span><span class="nt">&quot;failAuthentication&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span class="w">        </span><span class="nt">&quot;challengeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PASSWORD_VERIFIER&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;region&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;us-east-1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;userPoolId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;us-east-1_example&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;userName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UserName&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;callerContext&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;awsSdkVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;awsSdkVersion&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;clientId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;clientId&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;triggerSource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DefineAuthChallenge_Authentication&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;userAttributes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;sub&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4A709A36-7D63-4785-829D-4198EF10EBDA&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;email_verified&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;First Last&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;define-auth@mail.com&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;session&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;challengeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SRP_A&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;challengeResult&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;challengeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PASSWORD_VERIFIER&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;challengeResult&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;response&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">        </span><span class="nt">&quot;issueTokens&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span class="hll"><span class="w">        </span><span class="nt">&quot;failAuthentication&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span class="hll"><span class="w">        </span><span class="nt">&quot;challengeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CUSTOM_CHALLENGE&quot;</span>
</span><span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;region&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;us-east-1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;userPoolId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;us-east-1_example&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;userName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UserName&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;callerContext&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;awsSdkVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;awsSdkVersion&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;clientId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;clientId&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;triggerSource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DefineAuthChallenge_Authentication&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;userAttributes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;sub&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4A709A36-7D63-4785-829D-4198EF10EBDA&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;email_verified&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;First Last&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;define-auth@mail.com&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;session&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;challengeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SRP_A&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;challengeResult&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;challengeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PASSWORD_VERIFIER&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;challengeResult&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;challengeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CUSTOM_CHALLENGE&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;challengeResult&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;response&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">        </span><span class="nt">&quot;issueTokens&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span class="hll"><span class="w">        </span><span class="nt">&quot;failAuthentication&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
</span><span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h4 id="create-auth-challenge-example">Create Auth Challenge Example<a class="headerlink" href="#create-auth-challenge-example" title="Permanent link">&para;</a></h4>
<p>This example is based on the AWS Cognito docs for <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-create-auth-challenge.html" target="_blank">Create Auth Challenge Lambda Trigger</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:1"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.cognito_user_pool_event</span> <span class="kn">import</span> <span class="n">CreateAuthChallengeTriggerEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">CreateAuthChallengeTriggerEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">CreateAuthChallengeTriggerEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">challenge_name</span> <span class="o">==</span> <span class="s2">&quot;CUSTOM_CHALLENGE&quot;</span><span class="p">:</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">public_challenge_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;captchaUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;url/123.jpg&quot;</span><span class="p">}</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">private_challenge_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;answer&quot;</span><span class="p">:</span> <span class="s2">&quot;5&quot;</span><span class="p">}</span>
        <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">challenge_metadata</span> <span class="o">=</span> <span class="s2">&quot;CAPTCHA_CHALLENGE&quot;</span>
    <span class="k">return</span> <span class="n">event</span><span class="o">.</span><span class="n">raw_event</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h4 id="verify-auth-challenge-response-example">Verify Auth Challenge Response Example<a class="headerlink" href="#verify-auth-challenge-response-example" title="Permanent link">&para;</a></h4>
<p>This example is based on the AWS Cognito docs for <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-verify-auth-challenge-response.html" target="_blank">Verify Auth Challenge Response Lambda Trigger</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:1"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="__tabbed_21_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.cognito_user_pool_event</span> <span class="kn">import</span> <span class="n">VerifyAuthChallengeResponseTriggerEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">VerifyAuthChallengeResponseTriggerEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">VerifyAuthChallengeResponseTriggerEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="n">event</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">answer_correct</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">private_challenge_parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;answer&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">challenge_answer</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">event</span><span class="o">.</span><span class="n">raw_event</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="connect-contact-flow">Connect Contact Flow<a class="headerlink" href="#connect-contact-flow" title="Permanent link">&para;</a></h3>
<blockquote>
<p>New in 1.11.0</p>
</blockquote>
<div class="tabbed-set tabbed-alternate" data-tabs="22:1"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="__tabbed_22_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.connect_contact_flow_event</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ConnectContactFlowChannel</span><span class="p">,</span>
    <span class="n">ConnectContactFlowEndpointType</span><span class="p">,</span>
    <span class="n">ConnectContactFlowEvent</span><span class="p">,</span>
    <span class="n">ConnectContactFlowInitiationMethod</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">event</span><span class="p">:</span> <span class="n">ConnectContactFlowEvent</span> <span class="o">=</span> <span class="n">ConnectContactFlowEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">event</span><span class="o">.</span><span class="n">contact_data</span><span class="o">.</span><span class="n">attributes</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;Language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span><span class="p">}</span>
    <span class="k">assert</span> <span class="n">event</span><span class="o">.</span><span class="n">contact_data</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="n">ConnectContactFlowChannel</span><span class="o">.</span><span class="n">VOICE</span>
    <span class="k">assert</span> <span class="n">event</span><span class="o">.</span><span class="n">contact_data</span><span class="o">.</span><span class="n">customer_endpoint</span><span class="o">.</span><span class="n">endpoint_type</span> <span class="o">==</span> <span class="n">ConnectContactFlowEndpointType</span><span class="o">.</span><span class="n">TELEPHONE_NUMBER</span>
    <span class="k">assert</span> <span class="n">event</span><span class="o">.</span><span class="n">contact_data</span><span class="o">.</span><span class="n">initiation_method</span> <span class="o">==</span> <span class="n">ConnectContactFlowInitiationMethod</span><span class="o">.</span><span class="n">API</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="dynamodb-streams">DynamoDB Streams<a class="headerlink" href="#dynamodb-streams" title="Permanent link">&para;</a></h3>
<p>The DynamoDB data class utility provides the base class for <code>DynamoDBStreamEvent</code>, as well as enums for stream view type (<code>StreamViewType</code>) and event type.
(<code>DynamoDBRecordEventName</code>).
The class automatically deserializes DynamoDB types into their equivalent Python types.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="23:2"><input checked="checked" id="__tabbed_23_1" name="__tabbed_23" type="radio" /><input id="__tabbed_23_2" name="__tabbed_23" type="radio" /><div class="tabbed-labels"><label for="__tabbed_23_1">app.py</label><label for="__tabbed_23_2">multiple_records_types.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.dynamo_db_stream_event</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DynamoDBStreamEvent</span><span class="p">,</span>
    <span class="n">DynamoDBRecordEventName</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">event</span><span class="p">:</span> <span class="n">DynamoDBStreamEvent</span> <span class="o">=</span> <span class="n">DynamoDBStreamEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="c1"># Multiple records can be delivered in a single event</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">records</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">event_name</span> <span class="o">==</span> <span class="n">DynamoDBRecordEventName</span><span class="o">.</span><span class="n">MODIFY</span><span class="p">:</span>
            <span class="n">do_something_with</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">dynamodb</span><span class="o">.</span><span class="n">new_image</span><span class="p">)</span>
            <span class="n">do_something_with</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">dynamodb</span><span class="o">.</span><span class="n">old_image</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">DynamoDBStreamEvent</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.typing</span> <span class="kn">import</span> <span class="n">LambdaContext</span>


<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">DynamoDBStreamEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">DynamoDBStreamEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">LambdaContext</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">records</span><span class="p">:</span>
        <span class="c1"># {&quot;N&quot;: &quot;123.45&quot;} =&gt; Decimal(&quot;123.45&quot;)</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">dynamodb</span><span class="o">.</span><span class="n">keys</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="eventbridge">EventBridge<a class="headerlink" href="#eventbridge" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="24:1"><input checked="checked" id="__tabbed_24_1" name="__tabbed_24" type="radio" /><div class="tabbed-labels"><label for="__tabbed_24_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">EventBridgeEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">EventBridgeEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">EventBridgeEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">do_something_with</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">detail</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="kafka">Kafka<a class="headerlink" href="#kafka" title="Permanent link">&para;</a></h3>
<p>This example is based on the AWS docs for <a href="https://docs.aws.amazon.com/lambda/latest/dg/with-msk.html" target="_blank">Amazon MSK</a> and <a href="https://docs.aws.amazon.com/lambda/latest/dg/with-kafka.html" target="_blank">self-managed Apache Kafka</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="25:1"><input checked="checked" id="__tabbed_25_1" name="__tabbed_25" type="radio" /><div class="tabbed-labels"><label for="__tabbed_25_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">KafkaEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">KafkaEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">KafkaEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">records</span><span class="p">:</span>
        <span class="n">do_something_with</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">decoded_key</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">json_value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="kinesis-streams">Kinesis streams<a class="headerlink" href="#kinesis-streams" title="Permanent link">&para;</a></h3>
<p>Kinesis events by default contain base64 encoded data. You can use the helper function to access the data either as json
or plain text, depending on the original payload.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="26:1"><input checked="checked" id="__tabbed_26_1" name="__tabbed_26" type="radio" /><div class="tabbed-labels"><label for="__tabbed_26_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">KinesisStreamEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">KinesisStreamEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">KinesisStreamEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">kinesis_record</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">records</span><span class="p">)</span><span class="o">.</span><span class="n">kinesis</span>

    <span class="c1"># if data was delivered as text</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">kinesis_record</span><span class="o">.</span><span class="n">data_as_text</span><span class="p">()</span>

    <span class="c1"># if data was delivered as json</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">kinesis_record</span><span class="o">.</span><span class="n">data_as_json</span><span class="p">()</span>

    <span class="n">do_something_with</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="kinesis-firehose-delivery-stream">Kinesis Firehose delivery stream<a class="headerlink" href="#kinesis-firehose-delivery-stream" title="Permanent link">&para;</a></h3>
<p>Kinesis Firehose Data Transformation can use a Lambda Function to modify the records
inline, and re-emit them back to the Delivery Stream.</p>
<p>Similar to Kinesis Data Streams, the events contain base64 encoded data. You can use the helper
function to access the data either as json or plain text, depending on the original payload.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="27:1"><input checked="checked" id="__tabbed_27_1" name="__tabbed_27" type="radio" /><div class="tabbed-labels"><label for="__tabbed_27_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">KinesisFirehoseEvent</span><span class="p">,</span>
    <span class="n">event_source</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.typing</span> <span class="kn">import</span> <span class="n">LambdaContext</span>


<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">KinesisFirehoseEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">KinesisFirehoseEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">LambdaContext</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">records</span><span class="p">:</span>
        <span class="c1"># if data was delivered as json; caches loaded value</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">data_as_json</span>

        <span class="n">processed_record</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;recordId&quot;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">record_id</span><span class="p">,</span>
            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)),</span>
            <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="s2">&quot;Ok&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">processed_record</span><span class="p">)</span>

    <span class="c1"># return transformed records</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;records&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="lambda-function-url">Lambda Function URL<a class="headerlink" href="#lambda-function-url" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="28:1"><input checked="checked" id="__tabbed_28_1" name="__tabbed_28" type="radio" /><div class="tabbed-labels"><label for="__tabbed_28_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">LambdaFunctionUrlEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">LambdaFunctionUrlEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">LambdaFunctionUrlEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">do_something_with</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="rabbit-mq">Rabbit MQ<a class="headerlink" href="#rabbit-mq" title="Permanent link">&para;</a></h3>
<p>It is used for <a href="https://docs.aws.amazon.com/lambda/latest/dg/with-mq.html" target="_blank">Rabbit MQ payloads</a>, also see
the <a href="https://aws.amazon.com/blogs/compute/using-amazon-mq-for-rabbitmq-as-an-event-source-for-lambda/" target="_blank">blog post</a>
for more details.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="29:1"><input checked="checked" id="__tabbed_29_1" name="__tabbed_29" type="radio" /><div class="tabbed-labels"><label for="__tabbed_29_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>

<span class="kn">from</span> <span class="nn">aws_lambda_powertools</span> <span class="kn">import</span> <span class="n">Logger</span>
<span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.rabbit_mq_event</span> <span class="kn">import</span> <span class="n">RabbitMQEvent</span>
</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">()</span>

<span class="hll"><span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">RabbitMQEvent</span><span class="p">)</span>
</span><span class="hll"><span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">RabbitMQEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
</span>    <span class="k">for</span> <span class="n">queue_name</span><span class="p">,</span> <span class="n">messages</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">rmq_messages_by_queue</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Messages for queue: </span><span class="si">{</span><span class="n">queue_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MessageID: </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">basic_properties</span><span class="o">.</span><span class="n">message_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">json_data</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Process json in base64 encoded data str&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="s3">S3<a class="headerlink" href="#s3" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="30:1"><input checked="checked" id="__tabbed_30_1" name="__tabbed_30" type="radio" /><div class="tabbed-labels"><label for="__tabbed_30_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">unquote_plus</span>
<span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">S3Event</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">S3Event</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">S3Event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">bucket_name</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">bucket_name</span>

    <span class="c1"># Multiple records can be delivered in a single event</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">records</span><span class="p">:</span>
        <span class="n">object_key</span> <span class="o">=</span> <span class="n">unquote_plus</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">get_object</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>

        <span class="n">do_something_with</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">object_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="s3-object-lambda">S3 Object Lambda<a class="headerlink" href="#s3-object-lambda" title="Permanent link">&para;</a></h3>
<p>This example is based on the AWS Blog post <a href="https://aws.amazon.com/blogs/aws/introducing-amazon-s3-object-lambda-use-your-code-to-process-data-as-it-is-being-retrieved-from-s3/" target="_blank">Introducing Amazon S3 Object Lambda – Use Your Code to Process Data as It Is Being Retrieved from S3</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="31:1"><input checked="checked" id="__tabbed_31_1" name="__tabbed_31" type="radio" /><div class="tabbed-labels"><label for="__tabbed_31_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="kn">from</span> <span class="nn">aws_lambda_powertools</span> <span class="kn">import</span> <span class="n">Logger</span>
<span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.logging.correlation_paths</span> <span class="kn">import</span> <span class="n">S3_OBJECT_LAMBDA</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes.s3_object_event</span> <span class="kn">import</span> <span class="n">S3ObjectLambdaEvent</span>
</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">()</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>

<span class="hll"><span class="nd">@logger</span><span class="o">.</span><span class="n">inject_lambda_context</span><span class="p">(</span><span class="n">correlation_id_path</span><span class="o">=</span><span class="n">S3_OBJECT_LAMBDA</span><span class="p">,</span> <span class="n">log_event</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="hll">    <span class="n">event</span> <span class="o">=</span> <span class="n">S3ObjectLambdaEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span>
    <span class="c1"># Get object from S3</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">input_s3_url</span><span class="p">)</span>
    <span class="n">original_object</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

    <span class="c1"># Make changes to the object about to be returned</span>
    <span class="n">transformed_object</span> <span class="o">=</span> <span class="n">original_object</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

    <span class="c1"># Write object back to S3 Object Lambda</span>
    <span class="n">s3</span><span class="o">.</span><span class="n">write_get_object_response</span><span class="p">(</span>
        <span class="n">Body</span><span class="o">=</span><span class="n">transformed_object</span><span class="p">,</span> <span class="n">RequestRoute</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">request_route</span><span class="p">,</span> <span class="n">RequestToken</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">request_token</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="s3-eventbridge-notification">S3 EventBridge Notification<a class="headerlink" href="#s3-eventbridge-notification" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="32:1"><input checked="checked" id="__tabbed_32_1" name="__tabbed_32" type="radio" /><div class="tabbed-labels"><label for="__tabbed_32_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">S3EventBridgeNotificationEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">S3EventBridgeNotificationEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">S3EventBridgeNotificationEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="n">bucket_name</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">bucket</span><span class="o">.</span><span class="n">name</span>
    <span class="n">file_key</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">key</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="ses">SES<a class="headerlink" href="#ses" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="33:1"><input checked="checked" id="__tabbed_33_1" name="__tabbed_33" type="radio" /><div class="tabbed-labels"><label for="__tabbed_33_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">SESEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">SESEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">SESEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="c1"># Multiple records can be delivered in a single event</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">records</span><span class="p">:</span>
        <span class="n">mail</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">ses</span><span class="o">.</span><span class="n">mail</span>
        <span class="n">common_headers</span> <span class="o">=</span> <span class="n">mail</span><span class="o">.</span><span class="n">common_headers</span>

        <span class="n">do_something_with</span><span class="p">(</span><span class="n">common_headers</span><span class="o">.</span><span class="n">to</span><span class="p">,</span> <span class="n">common_headers</span><span class="o">.</span><span class="n">subject</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="sns">SNS<a class="headerlink" href="#sns" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="34:1"><input checked="checked" id="__tabbed_34_1" name="__tabbed_34" type="radio" /><div class="tabbed-labels"><label for="__tabbed_34_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">SNSEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">SNSEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">SNSEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="c1"># Multiple records can be delivered in a single event</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">records</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">sns</span><span class="o">.</span><span class="n">message</span>
        <span class="n">subject</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">sns</span><span class="o">.</span><span class="n">subject</span>

        <span class="n">do_something_with</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="sqs">SQS<a class="headerlink" href="#sqs" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="35:1"><input checked="checked" id="__tabbed_35_1" name="__tabbed_35" type="radio" /><div class="tabbed-labels"><label for="__tabbed_35_1">app.py</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">SQSEvent</span>

<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">SQSEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">SQSEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="c1"># Multiple records can be delivered in a single event</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">records</span><span class="p">:</span>
        <span class="n">do_something_with</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="vpc-lattice">VPC Lattice<a class="headerlink" href="#vpc-lattice" title="Permanent link">&para;</a></h3>
<p>You can register your Lambda functions as targets within an Amazon VPC Lattice service network. By doing this, your Lambda function becomes a service within the network, and clients that have access to the VPC Lattice service network can call your service.</p>
<p><a href="https://docs.aws.amazon.com/lambda/latest/dg/services-vpc-lattice.html" target="_blank">Click here</a> for more information about using AWS Lambda with Amazon VPC Lattice.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="36:2"><input checked="checked" id="__tabbed_36_1" name="__tabbed_36" type="radio" /><input id="__tabbed_36_2" name="__tabbed_36" type="radio" /><div class="tabbed-labels"><label for="__tabbed_36_1">app.py</label><label for="__tabbed_36_2">Lattice Example Event</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools</span> <span class="kn">import</span> <span class="n">Logger</span>
<span class="hll"><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="n">VPCLatticeEvent</span><span class="p">,</span> <span class="n">event_source</span>
</span><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.typing</span> <span class="kn">import</span> <span class="n">LambdaContext</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">()</span>


<span class="hll"><span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">VPCLatticeEvent</span><span class="p">)</span>
</span><span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">VPCLatticeEvent</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">LambdaContext</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;isBase64Encoded&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;statusCode&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/text&quot;</span><span class="p">},</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;Event Response to VPC Lattice 🔥🚀🔥&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;raw_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/testpath&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;headers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user_agent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;curl/7.64.1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;x-forwarded-for&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.213.229.10&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;host&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test-lambda-service-3908sdf9u3u.dkfjd93.vpc-lattice-svcs.us-east-2.on.aws&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;accept&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*/*&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;query_string_parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;order-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;body&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;eyJ0ZXN0IjogImV2ZW50In0=&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;is_base64_encoded&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h2 id="advanced">Advanced<a class="headerlink" href="#advanced" title="Permanent link">&para;</a></h2>
<h3 id="debugging">Debugging<a class="headerlink" href="#debugging" title="Permanent link">&para;</a></h3>
<p>Alternatively, you can print out the fields to obtain more information. All classes come with a <code>__str__</code> method that generates a dictionary string which can be quite useful for debugging.</p>
<p>However, certain events may contain sensitive fields such as <code>secret_access_key</code> and <code>session_token</code>, which are labeled as <code>[SENSITIVE]</code> to prevent any accidental disclosure of confidential information.</p>
<div class="admonition warning">
<p class="admonition-title">If we fail to deserialize a field value (e.g., JSON), they will appear as <code>[Cannot be deserialized]</code></p>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="37:3"><input checked="checked" id="__tabbed_37_1" name="__tabbed_37" type="radio" /><input id="__tabbed_37_2" name="__tabbed_37" type="radio" /><input id="__tabbed_37_3" name="__tabbed_37" type="radio" /><div class="tabbed-labels"><label for="__tabbed_37_1">debugging.py</label><label for="__tabbed_37_2">debugging_event.json</label><label for="__tabbed_37_3">debugging_output.json</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">aws_lambda_powertools.utilities.data_classes</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CodePipelineJobEvent</span><span class="p">,</span>
    <span class="n">event_source</span><span class="p">,</span>
<span class="p">)</span>


<span class="nd">@event_source</span><span class="p">(</span><span class="n">data_class</span><span class="o">=</span><span class="n">CodePipelineJobEvent</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="hll">    <span class="nb">print</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;CodePipeline.job&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;11111111-abcd-1111-abcd-111111abcdef&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;accountId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;111111111111&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;actionConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;configuration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;FunctionName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MyLambdaFunctionForAWSCodePipeline&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;UserParameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;some-input-such-as-a-URL&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;inputArtifacts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ArtifactName&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;revision&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;S3&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;s3Location&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nt">&quot;bucketName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;the name of the bucket configured as the pipeline artifact store in Amazon S3, for example codepipeline-us-east-2-1234567890&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="nt">&quot;objectKey&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;the name of the application, for example CodePipelineDemoApplication.zip&quot;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;outputArtifacts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">            </span><span class="nt">&quot;artifactCredentials&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;accessKeyId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AKIAIOSFODNN7EXAMPLE&quot;</span><span class="p">,</span>
<span class="hll"><span class="w">                </span><span class="nt">&quot;secretAccessKey&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;sessionToken&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MIICiTCCAfICCQD6m7oRw0uXOjANBgkqhkiG9w0BAQUFADCBiDELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAldBMRAwDgYDVQQHEwdTZWF0dGxlMQ8wDQYDVQQKEwZBbWF6b24xFDASBgNVBAsTC0lBTSBDb25zb2xlMRIwEAYDVQQDEwlUZXN0Q2lsYWMxHzAdBgkqhkiG9w0BCQEWEG5vb25lQGFtYXpvbi5jb20wHhcNMTEwNDI1MjA0NTIxWhcNMTIwNDI0MjA0NTIxWjCBiDELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAldBMRAwDgYDVQQHEwdTZWF0dGxlMQ8wDQYDVQQKEwZBbWF6b24xFDASBgNVBAsTC0lBTSBDb25zb2xlMRIwEAYDVQQDEwlUZXN0Q2lsYWMxHzAdBgkqhkiG9w0BCQEWEG5vb25lQGFtYXpvbi5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMaK0dn+a4GmWIWJ21uUSfwfEvySWtC2XADZ4nB+BLYgVIk60CpiwsZ3G93vUEIO3IyNoH/f0wYK8m9TrDHudUZg3qX4waLG5M43q7Wgc/MbQITxOUSQv7c7ugFFDzQGBzZswY6786m86gpEIbb3OhjZnzcvQAaRHhdlQWIMm2nrAgMBAAEwDQYJKoZIhvcNAQEFBQADgYEAtCu4nUhVVxYUntneD9+h8Mg9q6q+auNKyExzyLwaxlAoo7TJHidbtS4J5iNmZgXL0FkbFFBjvSfpJIlJ00zbhNYS5f6GuoEDmFJl0ZxBHjJnyp378OD8uTs7fLvjx79LjSTbNYiytVbZPQUQ5Yaxu2jXnimvw3rrszlaEXAMPLE=&quot;</span>
</span><span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;continuationToken&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A continuation token if continuing job&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;account_id&quot;</span><span class="p">:</span><span class="s2">&quot;111111111111&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:{</span>
<span class="w">       </span><span class="nt">&quot;action_configuration&quot;</span><span class="p">:{</span>
<span class="w">          </span><span class="nt">&quot;configuration&quot;</span><span class="p">:{</span>
<span class="w">             </span><span class="nt">&quot;decoded_user_parameters&quot;</span><span class="p">:</span><span class="s2">&quot;[Cannot be deserialized]&quot;</span><span class="p">,</span>
<span class="w">             </span><span class="nt">&quot;function_name&quot;</span><span class="p">:</span><span class="s2">&quot;MyLambdaFunctionForAWSCodePipeline&quot;</span><span class="p">,</span>
<span class="w">             </span><span class="nt">&quot;raw_event&quot;</span><span class="p">:</span><span class="s2">&quot;[SENSITIVE]&quot;</span><span class="p">,</span>
<span class="w">             </span><span class="nt">&quot;user_parameters&quot;</span><span class="p">:</span><span class="s2">&quot;some-input-such-as-a-URL&quot;</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nt">&quot;raw_event&quot;</span><span class="p">:</span><span class="s2">&quot;[SENSITIVE]&quot;</span>
<span class="w">       </span><span class="p">},</span>
<span class="w">       </span><span class="nt">&quot;artifact_credentials&quot;</span><span class="p">:{</span>
<span class="w">          </span><span class="nt">&quot;access_key_id&quot;</span><span class="p">:</span><span class="s2">&quot;AKIAIOSFODNN7EXAMPLE&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;expiration_time&quot;</span><span class="p">:</span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
<span class="hll"><span class="w">          </span><span class="nt">&quot;raw_event&quot;</span><span class="p">:</span><span class="s2">&quot;[SENSITIVE]&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;secret_access_key&quot;</span><span class="p">:</span><span class="s2">&quot;[SENSITIVE]&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;session_token&quot;</span><span class="p">:</span><span class="s2">&quot;[SENSITIVE]&quot;</span>
</span><span class="w">       </span><span class="p">},</span>
<span class="w">       </span><span class="nt">&quot;continuation_token&quot;</span><span class="p">:</span><span class="s2">&quot;A continuation token if continuing job&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="nt">&quot;encryption_key&quot;</span><span class="p">:</span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="nt">&quot;input_artifacts&quot;</span><span class="p">:[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">             </span><span class="nt">&quot;location&quot;</span><span class="p">:{</span>
<span class="w">                </span><span class="nt">&quot;get_type&quot;</span><span class="p">:</span><span class="s2">&quot;S3&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;raw_event&quot;</span><span class="p">:</span><span class="s2">&quot;[SENSITIVE]&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;s3_location&quot;</span><span class="p">:{</span>
<span class="w">                   </span><span class="nt">&quot;bucket_name&quot;</span><span class="p">:</span><span class="s2">&quot;the name of the bucket configured as the pipeline artifact store in Amazon S3, for example codepipeline-us-east-2-1234567890&quot;</span><span class="p">,</span>
<span class="w">                   </span><span class="nt">&quot;key&quot;</span><span class="p">:</span><span class="s2">&quot;the name of the application, for example CodePipelineDemoApplication.zip&quot;</span><span class="p">,</span>
<span class="w">                   </span><span class="nt">&quot;object_key&quot;</span><span class="p">:</span><span class="s2">&quot;the name of the application, for example CodePipelineDemoApplication.zip&quot;</span><span class="p">,</span>
<span class="w">                   </span><span class="nt">&quot;raw_event&quot;</span><span class="p">:</span><span class="s2">&quot;[SENSITIVE]&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">             </span><span class="p">},</span>
<span class="w">             </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;ArtifactName&quot;</span><span class="p">,</span>
<span class="w">             </span><span class="nt">&quot;raw_event&quot;</span><span class="p">:</span><span class="s2">&quot;[SENSITIVE]&quot;</span><span class="p">,</span>
<span class="w">             </span><span class="nt">&quot;revision&quot;</span><span class="p">:</span><span class="s2">&quot;None&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">       </span><span class="p">],</span>
<span class="w">       </span><span class="nt">&quot;output_artifacts&quot;</span><span class="p">:[</span>

<span class="w">       </span><span class="p">],</span>
<span class="w">       </span><span class="nt">&quot;raw_event&quot;</span><span class="p">:</span><span class="s2">&quot;[SENSITIVE]&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;decoded_user_parameters&quot;</span><span class="p">:</span><span class="s2">&quot;[Cannot be deserialized]&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;get_id&quot;</span><span class="p">:</span><span class="s2">&quot;11111111-abcd-1111-abcd-111111abcdef&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;input_bucket_name&quot;</span><span class="p">:</span><span class="s2">&quot;the name of the bucket configured as the pipeline artifact store in Amazon S3, for example codepipeline-us-east-2-1234567890&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;input_object_key&quot;</span><span class="p">:</span><span class="s2">&quot;the name of the application, for example CodePipelineDemoApplication.zip&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;raw_event&quot;</span><span class="p">:</span><span class="s2">&quot;[SENSITIVE]&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;user_parameters&quot;</span><span class="p">:</span><span class="s2">&quot;some-input-such-as-a-URL&quot;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
```</p>
</div>
</div>
</div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      2023-07-09
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 Amazon Web Services
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.sections", "navigation.expand", "navigation.top", "navigation.instant", "navigation.indexes", "navigation.tracking", "content.code.annotate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../../javascript/aws-amplify.min.js"></script>
        
      
        
          <script src="../../javascript/extra.js"></script>
        
      
    
  </body>
</html>